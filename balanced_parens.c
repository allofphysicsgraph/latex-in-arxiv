/*
./a.out sound1.tex 0
(3554,3647):\begin{equation}
\frac{v_u}{c}=\alpha\left(\frac{m_e}{2m_p}\right)^{\frac{1}{2}},
\label{v0}
\end{equation}
(7149,7220):\begin{equation}
v=\left(\frac{E}{m}\right)^{\frac{1}{2}}.
\label{v01}
\end{equation}
(7371,7457):\begin{equation}
E_{\rm R}=\frac{m_ee^4}{32\pi^2\epsilon_0^2\hbar^2},
\label{rydberg}
\end{equation}
(7693,7774):\begin{equation}
v=\alpha\left(\frac{m_e}{2m}\right)^{\frac{1}{2}}c,
\label{v00}
\end{equation}
(8431,8493):\begin{equation}
v=\frac{1}{\pi}\omega_{\rm D}a.
\label{v001}
\end{equation}
(8647,8726):\begin{equation}
a_{\rm B}=\frac{4\pi\epsilon_0\hbar^2}{m_e e^2}.
\label{bohr}
\end{equation}
(9188,9291):\begin{equation}
\frac{\hbar\omega_{\rm D}}{E}=\left(\frac{m_e}{m}\right)^{\frac{1}{2}}.
\label{ratio}
\end{equation}
(9349,9440):\begin{equation}
v=\frac{Ea}{\pi\hbar}\left(\frac{m_e}{m}\right)^{\frac{1}{2}}.
\label{v1}
\end{equation}
(11635,11754):\begin{equation}
v_u=\alpha\left(\frac{m_e}{2m_p}\right)^{\frac{1}{2}}c~\approx~36,100~\frac{\rm m}{\rm s},
\label{v3}
\end{equation}
(12138,12194):\begin{equation}
v=\frac{v_u}{A^\frac{1}{2}}.
\label{a}
\end{equation}
(253,310):\title{Speed of sound from fundamental physical constants}
(312,332):\author{K. Trachenko}
(448,468):\author{B. Monserrat}
(736,757):\author{C. J. Pickard}
(997,1019):\author{V. V. Brazhkin}
(334,446):\affiliation{School of Physics and Astronomy, Queen Mary University of London, Mile End Road, London, E1 4NS, UK}
(471,615):\affiliation{Department of Materials Science and Metallurgy, University of Cambridge, 27 Charles Babbage Road, Cambridge CB3 0FS, United Kingdom}
(619,734):\affiliation{Cavendish Laboratory, University of Cambridge, J. J. Thomson Avenue, Cambridge CB3 0HE, United Kingdom}
(760,904):\affiliation{Department of Materials Science and Metallurgy, University of Cambridge, 27 Charles Babbage Road, Cambridge CB3 0FS, United Kingdom}
(907,995):\affiliation{Advanced Institute for Materials Research, Tohoku University, Sendai, Japan}
(1021,1107):\affiliation{Institute for High Pressure Physics, RAS, 108840, Troitsk, Moscow, Russia}
(1110,1965):\begin{abstract}
Two dimensionless fundamental physical constants, the fine structure constant $\alpha$ and the proton-to-electron mass ratio $\frac{m_p}{m_e}$ are attributed a particular importance from the point of view of nuclear synthesis, formation of heavy elements, planets, and life-supporting structures. Here, we show that a combination of these two constants results in a new dimensionless constant which provides the upper bound for the speed of sound in condensed phases, $v_u$. We find that $\frac{v_u}{c}=\alpha\left(\frac{m_e}{2m_p}\right)^{\frac{1}{2}}$, where $c$ is the speed of light in vacuum. We support this result by a large set of experimental data and first principles computations for atomic hydrogen. Our result expands current understanding of how fundamental constants can impose new bounds on important physical properties.
\end{abstract}
(2446,2460):\cite{ashcroft}
(2605,2617):\cite{barrow}
(3183,3195):\cite{barrow}
(4089,4161):\cite{kss,zaanen3,hartnoll,zaanen2,spin,behnia,zaanen1,behnia1,hartnoll1}
(4546,4618):\cite{kss,zaanen3,hartnoll,zaanen2,spin,behnia,zaanen1,behnia1,hartnoll1}
(4738,4750):\cite{sciadv}
(5090,5102):\cite{landau}
(5366,5380):\cite{phillips}
(5596,5608):\cite{landau}
(6450,6472):\cite{diamond,diamond1}
(6687,6709):\cite{diamond,diamond1}
(7352,7366):\cite{ashcroft}
(7614,7628):\cite{ashcroft}
(11136,11148):\cite{barrow}
(12211,18884):\begin{thebibliography}{99}

\bibitem{ashcroft} N. W. Ashcroft and N. D. Mermin, {\it Solid State Physics} (Saunders College Publishing, 1976).

\bibitem{barrow} J. D. Barrow, {\it The Constants of Nature} (Pantheon Books, 2003).

\bibitem{kss} P. K. Kovtun, D. T. Son and A. O. Starinets, Starinets, Viscosity in strongly interacting quantum field
theories from black hole physics. {\it Phys. Rev. Lett.} {\bf 94}, 111601 (2005).

\bibitem{zaanen3} J. Zaanen, Why the temperature is high. {\it Nature} {\bf 430}, 512-513 (2004).

\bibitem{hartnoll} S. A. Hartnoll, Theory of universal incoherent metallic transport. {\it Nat. Phys.} {\bf 11}, 54-61 (2015).

\bibitem{zaanen2} J. Zaanen, Planckian dissipation, minimal viscosity and the transport in cuprate strange
metals. {\it SciPost Phys.} {\bf 6}, 061 (2019).

\bibitem{spin} C. Luciuk et al, Observation of quantum-limited spin transport in strongly interacting two-dimensional
Fermi gases. {\it Phys. Rev. Lett.} {\bf 118}, 130405 (2017).

\bibitem{behnia} K. Behnia and A. Kapitulnik, A lower bound to the thermal diffusivity
of insulators. {\it J. Phys.: Condens. Matt.} {\bf 31}, 405702 (2019).

\bibitem{zaanen1} J. Zaanen, Y. Liu, Y. W. Sun and K. Schalm, Holographic duality in condensed matter physics (Cambridge University Press, 2015).

\bibitem{behnia1} Y. Machida, N. Matsumoto, T. Isono and K. Behnia, Phonon hydrodynamics and ultrahighâ€“roomtemperature
thermal conductivity in thin graphite. {\it Science}, {\bf 367}, 309 (2020).

\bibitem{hartnoll1} C. H. Mousatov and S. A. Hartnoll, On the Planckian bound for heat diffusion in insulators. {\it Nat. Phys.} {\bf 16}, 579-584 (2020).

\bibitem{sciadv} K. Trachenko and V. V. Brazhkin, Minimal quantum viscosity from fundamental physical constants. {\it Science Adv.} {\bf 6}, eaba3747 (2020).

\bibitem{landau} L. D. Landau and E. M. Lifshitz, Statistical Physics
(Oxford: Pergamon, 1969).

\bibitem{phillips} J. C. Phillips, Ionicity of the chemical bond in crystals. {\it Rev. Mod. Phys.} {\bf 42}, 317-356 (1970).

\bibitem{zaccone} B. Cui, A. Zaccone and D. Rodney, Nonaffine lattice dynamics with the Ewald method reveals strongly nonaffine elasticity of $\alpha$-quartz.
{\it J. Chem. Phys.} {\bf 151}, 224509 (2019).

\bibitem{diamond} V. V. Brazhkin, A. G. Lyapin and R. J. Hemley, {\it Phil. Mag.} {\bf 82}, 231-253 (2002).

\bibitem{diamond1} V. V. Brazhkin and V. L. Solozhenko, Myths about new ultrahard phases: Why materials that are significantly superior to diamond in elastic moduli and hardness are impossible. {\it J. Appl. Phys.} {\bf 125}, 130901 (2019).

%\bibitem{young} D. A. Young, Phase Diagrams of Elements (University of California Press, 1991).

\bibitem{handbook} CRC Handbook of Chemistry and Physics (ed. D. R. Lide, CRC Press, 2004).

\bibitem{handbook1} I. N. Frantsevich, F. F. Voronov and S. A. Bakuta, {\it Elastic constants and elastic moduli of metals and non-metals} (Kyiv, Naukova Dumka, 1982).

\bibitem{handbook2} Properties of Elements (Ed. M. E. Drits, Moscow Metallurgy, 1997).

\bibitem{correlation} B. Ratner, {\it Statistical and machine-learning data mining} (CRC Press, Taylor and Francis, 2011).

\bibitem{metals} T. Iida and R. I. L. Guthrie, {\it The Physical Properties of Liquid Metals} (Oxford University Press, 1988).

\bibitem{f2} V. V. Brazhkin and K. Trachenko, What separates a liquid from a gas? {\it Physics Today} 65(11), 68 (2012).

\bibitem{frenkel} J. Frenkel, {\it Kinetic Theory of Liquids} (Oxford University Press, New York, 1947).

\bibitem{boon} J. P. Boon and S. Yip, {\it Molecular Hydrodynamics} (New York: Dover, 1980).

\bibitem{f1} V. V. Brazhkin et al, ``Liquid-gas'' transition in the supercritical region: fundamental changes in particle dynamics. {\it Phys. Rev. Lett.} {\bf 111}, 145901 (2013).

\bibitem{f3} K. Trachenko and V. V. Brazhkin, Collective modes and thermodynamics of the liquids state. {\it Rep. Prog. Phys.} {\bf 79}, 016502 (2016).

\bibitem{gitis} M. B. Gitis and I. G. Mikhailov, On calculation of the speed of sound in liquid metals. {\it Acoustical Journal} {\bf 13}, 556-561 (1967) (in Russian).

\bibitem{vadim1} V. V. Brazhkin, Interparticle interaction in condensed media: some elements are ``more equal than others''. {\it Phys. Uspekhi} {\bf 52}, 369-376 (2009).

\bibitem{silvera} R. P. Dias and I. F. Silvera, Observation of the Wigner-Huntington transition to metallic hydrogen. {\it Science} {\bf 355}, 715-718 (2017).

\bibitem{loubeyre} P. Loubeyre, F. Occelli, and P. Dumas, Synchrotron infrared spectroscopic evidence of the probable transition to metal hydrogen. {\it Nature} {\bf 577}, 631-635 (2020).

\bibitem{hydrogen} J. M. McMahon, M. A. Morales, C. Pierleoni, and D. M. Ceperley, The properties of hydrogen and helium under extreme conditions. {\it Rev. Mod. Phys.} {\bf 84}, 1607-1653 (2012).

\bibitem{i41amd} K. Nagao, H. Nagara, and S. Matsubara, Structures of hydorgen at megabar pressures. {\it Phys. Rev. B} {\bf 56}, 2295-2298 (1997).

\bibitem{pickard_h_natphys} C. J. Pickard and R. J. Needs, Structure of phase III of solid hydrogen. {\it Nat. Phys.} {\bf 3}, 473 (2007).

\bibitem{azadi_metal} S. Azadi, B. Monserrat, W. M. C. Foulkes, and R. J. Needs, Dissociation of High-Pressure Solid Molecular Hydrogen: A Quantum Monte Carlo and Anharmonic Vibrational Study. {\it Phys. Rev. Lett.} {\bf 112}, 165501 (2014).

\bibitem{morales_metal} J. McMinis, R. C. Clay, D. Lee, and M. A. Morales, Molecular to Atomic Phase Transition in Hydrogen under High Pressure. {\it Phys. Rev. Lett.} {\bf 114}, 105305 (2015).

\bibitem{vadim2} V. V. Brazhkin and A. G. Lyapin, The inversion of relative shear rigidity in different material classes at megabar pressures. {\it J. Phys.: Condens. Matter} {\bf 14}, 10861-10867 (2002).

\bibitem{hadronic} P. Bedaque and A. W. Steiner, Sound Velocity Bound and Neutron Stars. {\it Phys. Rev. Lett.} {\bf 114}, 031103 (2015).

\bibitem{castep} S. J. Clark, M. D. Segall, C. J. Pickard, P. J. Hasnip, M. I. J. Probert, K. Refson, and M. C. Payne, First principles methods using CASTEP {\it Z. Kristallogr.} {\bf 220}, 567-570 (2005).

\bibitem{pbe} J. P. Perdew, K. Burke, and M. Ernzerhof, Generalized gradient approximation made simple, {\it Phys. Rev. Lett.} {\bf 77}, 3865-3868 (1996).

\bibitem{fd_martin} K. Kunc and R. M. Martin, Ab Initio Force Constants of GaAs: A New Approach to Calculation of Phonons and Dielectric Properties. {\it Phys. Rev. Lett.} {\bf 48}, 406-409 (1978).

\bibitem{nondiagonal} J. H. Lloyd-Williams and B. Monserrat, Lattice dynamics and electron-phonon coupling calculations using nondiagonal supercells. {\it Phys. Rev. B} {\bf 92}, 184301 (2015).

\end{thebibliography}

*/


#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/mman.h>
#include <errno.h>
#include <err.h>
#include <string.h>
#include <stdlib.h>

//https://rosettacode.org/wiki/Read_a_file_line_by_line#Using_mmap.28.29

int balanced_parens(const char * fname, char* start_pattern,char* l_delimiter,char* r_delimiter,int start_position)
{
        int fd = open(fname, O_RDONLY);
        struct stat fs;
        char *buf ;
	int start_index=0;
	int i = start_position;
	
	int balanced=0;
	if(!strcmp(start_pattern,l_delimiter)) { balanced=-1; }

        if (fd == -1) {
                err(1, "open: %s", fname);
                return 0;
        }
 
        if (fstat(fd, &fs) == -1) {
                err(1, "stat: %s", fname);
                return 0;
        }

	char tmp_data[fs.st_size];
	char result_data[fs.st_size];
	memset(tmp_data,'\0',fs.st_size);	
	memset(result_data,'\0',fs.st_size);	
	

	/* fs.st_size could have been 0 actually */
        buf = mmap(0, fs.st_size, PROT_READ, MAP_SHARED, fd, 0);
        if (buf == (void*) -1) {
                err(1, "mmap: %s", fname);
                close(fd);
                return 0;
        }
	for(i;i<fs.st_size;i++){
		strncpy(tmp_data,&buf[i],strlen(start_pattern));
	 	if(strcmp(tmp_data,start_pattern)==0){
			start_index=i;
			break;	
		}	
	}
	
	for(i;i<fs.st_size;i++){
		memset(tmp_data,'\0',fs.st_size);	
		strncpy(tmp_data,&buf[i],strlen(r_delimiter));
		if(!strcmp(tmp_data,r_delimiter)){
			balanced++;
			//printf("++");
			if(balanced==0){
				strncpy(result_data,&buf[start_index],i-start_index+1);
				if(!strcmp(start_pattern,l_delimiter)) { 
					if(r_delimiter[0]=='\\') { strcat(result_data,&r_delimiter[1]); } else { strcat(result_data,r_delimiter); }
				}
				printf("(%d,%d):%s\n",start_index,i,result_data);
				munmap(buf, fs.st_size);
				close(fd);
        			balanced_parens(fname, start_pattern,l_delimiter,r_delimiter,i+1);
				break;
			}
		}

		if(!strcmp(tmp_data,l_delimiter)){
			//printf("--");
			balanced--;
		}
	}

        munmap(buf, fs.st_size);
        close(fd);
        return 1;
}

 
int main(int argc, char ** argv)
{
	if(argc!=3) { printf("filename, seek_position"); return -1; }
	balanced_parens(argv[1], "\\begin{equation}","\\begin{equation}","\\end{equation}",atoi(argv[2]));
	balanced_parens(argv[1], "\\title","{","}",atoi(argv[2]));
	balanced_parens(argv[1], "\\author","{","}",atoi(argv[2]));
	balanced_parens(argv[1], "\\affiliation","{","}",atoi(argv[2]));
	balanced_parens(argv[1], "\\begin{abstract}","\\begin{abstract}","\\end{abstract}",atoi(argv[2]));
	balanced_parens(argv[1], "\\cite","{","}",atoi(argv[2]));
	balanced_parens(argv[1], "\\begin{thebibliography}","\\begin{thebibliography}","\\end{thebibliography}",atoi(argv[2]));
	return 0;
}
 
