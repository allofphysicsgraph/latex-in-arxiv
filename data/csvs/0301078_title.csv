,title
0,"\title
\maketitle
\tableofcontents
\section {Introduction}
\setcounter{equation}{0}
 Lie groups by no means exhaust symmetries in gauge theories.
Their importance is related to the natural geometric structures
defined by a group action in accordance with the Erlanger
program of F.Klein. The first class constraints in Hamiltonian systems
generate the canonical transformations of the phase space which generalize the
Lie group actions \cite{HT}.
There exists a powerful approach to treat such
types of structures. It is the BRST method that is applicable in
Hamiltonian and Lagrangian forms \cite{BFV}. The BRST operator
corresponding to arbitrary first class constraints acquires the most general
form. An intermediate step in this direction is the canonical transformations
generated by the quasigroups \cite{Ba,KM}.
The BRST operator for the quasigroup action has the same form as for
the Lie group case.

Here we consider the quasigroup symmetries
constructed by means of special transformations of the ""coordinate
space"" $M$. These transformations along with the coordinate space $M$ define
the Lie groupoids, or their infinitesimal version - the Lie algebroids
${\cal A}$ \cite{Ma,We}.
We lift the algebroid action from $M$ to the cotangent bundle $T^*M$,
or, more generally, to the
 principle homogeneous space ${\cal R}$ over
the cotangent bundle $T^*M$. We call this bundle
the Hamiltonian algebroid ${\cal A}^H$ related to the Lie algebroid ${\cal A}$.
The Hamiltonian algebroid is an analog of the Lie algebra of symplectic
vector fields with respect to the canonical symplectic structure on
${\cal R}$ or $T^*M$.
The lifts  from $M$ to ${\cal R}$'s are classified by the first cohomology group $H^1({\cal A})$.
We prove that the BRST operator of ${\cal A}^H$ has the same structure as
for the Lie algebras transformations.

The general example of this construction is the Poisson sigma-model \cite{I,SS}.
The Lie brackets of the Hamiltonian algebroid over the
phase space of the Poisson sigma-model are defined by the Poisson bivector on the target space $M$.

Our main interest lies in topological field
theories,
where the factorization with respect to the canonical gauge transformations
may lead to generalized  deformations of corresponding moduli spaces.
We apply
this scheme to analyze the moduli space of deformations of the
complex structures on Riemann curves
of genus $g$ with $n$  marked points $\Sigma_{g,n}$
by differential operators of finite order, or equivalently by the
Volterra operators.

To define the deformations
we start with the space $M_N$ of ${\rm SL}(N,{\mC})$-opers over $\Sigma_{g,n}$ \cite{Tel,BD},
 and define a Lie algebroid ${\cal A}_N$ over $M_N$. The Lie brackets on the space of sections
$\Gamma({\cal A}_N)$ are derived from the Adler-Gelfand-Dikii brackets for the
local opers over a punctured disk $D^*$ \cite{Ad,GD}. In this way the set of
the local opers serves as the target space of the Poisson sigma-model.
The space $M_2$ of $\SL2$-opers is the space of the projective structures on
$\Sigma_{g,n}$ and the Lie algebroid ${\cal A}_2$ leads to the Lie algebra of vector
fields on $\Sigma_{g,n}$. The case $N>2$ is more subtle and we deal with a genuine
Lie algebroids since differential operators of order greater than one do
not form a Lie algebra with respect to the standard commutator.
The AGD brackets define a new commutator on $\Gamma({\cal A}_N)$ that depends on
the projective structure and higher spin fields. In other words, for $N>2$
we deal with the structure functions rather than with the structure constants.

The space $M_N$ of ${\rm SL}(N,{\mC})$-opers can be considered as a configuration space
of $W_N$-gravity \cite{P,BFK,GLM}. The whole phase space ${\cal R}_N$
of $W_N$-gravity is the
affinization of the cotangent bundle $T^*M_N$. Its sections define the
deformations of the operator $\bar{\partial}$ by the Volterra
operators.  The canonical transformations of ${\cal R}_N$ are
sections of the Hamiltonian algebroid ${\cal A}_N^H$ over ${\cal R}_N$.
The symplectic quotient of the phase space
is the so-called ${\cal W}_N$-geometry of $\Sigma_{g,n}$. Roughly speaking, this space is
a combination of the moduli of generalized complex structures
 and the spin $2\,\ldots$,\,spin $N$ fields as the dual variables.
To define the ${\cal W}_N$-geometry
we construct the BRST operator for the Hamiltonian algebroid. As it follows from
the general construction, it has the same structure as in the Lie algebra case.
We consider in detail the simplest nontrivial case $N=3$. It is possible
in this case to describe
explicitly the sections of the algebroid as the second order differential operators,
instead of Volterra operators. This algebroid is
generalization
of the Lie algebra vector fields on $\Sigma_{g,n}$.
It should be noted that the BRST operator for the $W_3$-algebras was constructed
in \cite{TM}. But here we construct the BRST operator for the different object
- the algebroid symmetries of $W_3$-gravity.  Recently, another BRST description
of $W$-symmetries  was proposed in Ref.\cite{BL}.
We explain our formulae and the origin of the algebroid
by the special gauge procedure of the ${\rm SL}(N,{\mC})$ Chern-Simons theory using an
approach developed in Ref.\cite{BFK}.

The paper is organized as follows. In the next section we define the general
Hamiltonian algebroids, their cohomolgies and the BRST construction.
We also introduce a special class of Hamiltonian algebroids  related to
Lie algebroids and prove that the BRST has the Lie algebraic form.
In Section 3 we treat the Poisson sigma model and its symmetries as a
Hamiltonian algebroid  related to a Lie algebroid. In Section 4 we consider
two examples of our construction when the algebroids coincide with Lie algebras.
Namely, we analyze the moduli space of flat ${\rm SL}(N,{\mC})$-bundles
and the moduli of projective structures on $\Sigma_{g,n}$.
A nontrivial example of this construction is $W_3$-gravity.
It is considered in detail in Section 5.
The general case $W_N$ is analyzed in Section 6.


\section{Hamiltonian  algebroids and  groupoids}
\setcounter{equation}{0}

\subsection{Lie algebroids and groupoids}

We start with a brief description of Lie algebroids and Lie groupoids.
Details of this theory can be found in \cite{KM,Ma,We}.
\begin{defi}
A {\em Lie algebroid} over a differential manifold $M$ is a vector bundle
${\cal A}\rightarrow M$ with
a Lie algebra structure on the space of its sections $\Gamma({\cal A})$
 defined by the Lie brackets $\lb\varepsilon_1,\varepsilon_2\rb,\\
\varepsilon_1,\varepsilon_2\in\Gamma({\cal A})$ and
a bundle map ({\em the anchor}) $\delta :{\cal A}\to TM$, satisfying the following
conditions:\\
(i) For any $\varepsilon_1,\varepsilon_2\in\Gamma({\cal A})$
\begin{equation}\label{5.1}
[\delta_{\varepsilon_1},\delta_{\varepsilon_2}]=\delta_{\lb\varepsilon_1\varepsilon_2\rb}\,,
\end{equation}
(ii) For any $\varepsilon_1,\varepsilon_2\in\Gamma({\cal A})$ and $f\in C^\infty(M)$
\begin{equation}\label{5.2}
\lb\varepsilon_1,f\varepsilon_2\rb=f\lb\varepsilon_1,\varepsilon_2\rb + (\delta_{\varepsilon_1} f)\varepsilon_2\,.
\end{equation}
\end{defi}
In other words, the anchor  defines a representation of $\Gamma({\cal A})$
in the Lie algebra of vector fields
on $M$. The second condition is the Leibnitz rule with respect to the multiplication of
the sections by smooth functions.

Let $\{e^j(x)\}$ be a basis of local sections $\Gamma ({\cal A})$. Then  the brackets
are defined by the structure functions $f^{jk}_i(x)$ of the algebroid
\begin{equation}\label{5.1b}
\lb e^j,e^k\rb=f^{jk}_i(x)e^i\,,~~x\in M\,.
\end{equation}
Using the Jacobi identity for the anchor action, we find
\begin{equation}\label{5.3}
C^n_{j,k,m}\delta_{e_n}=0\,,
\end{equation}
where
\begin{equation}\label{5.4}
C^n_{jkm}=f^{jk}_i(x)f_n^{im}(x)+\delta_{e^m}f^{jk}_n(x)+{\rm c.p.}(j,k,m)\,.
\footnote{The sums over repeated indices are understood throughout the paper.}
\end{equation}
Thus, (\ref{5.3}) implies {\em the anomalous Jacobi identity} (AJI)
\begin{equation}\label{5.5}
f^{jk}_i(x)f_n^{im}(x)+\delta_{e^m}f^{jk}_n(x)+{\rm c.p.}(j,k,m)=0\,.
\end{equation}

Here are some examples of Lie algebroids.\\
1)If the anchor is trivial, then ${\cal A}$ is just a bundle of Lie algebras.\\
2)Consider an integrable system that has the Lax representation
$$
\partial_t{\cal L}=[{\cal L},{\cal M}]\,.
$$
The Lax operator ${\cal L}$ belongs to some subvariety $M$ of an ambient
space ${\cal R}$. In many cases it is
a Lie coalgebra. The second operator ${\cal M}$ defines the tangent vector field
to $M$.
The operators ${\cal M}$ are sections of the Lie algebroid ${\cal A}_M$ over
$M$ with the anchor determining by the Lax equation.
In the similar way the dressing transformations
are sections of the algebroid over $M$ \cite{Wei}.\\
3) Lie algebroids can be constructed from Lie algebras.
Let $G$ be a Lie group that act on a space $S$ and $P$ is subgroup of $G$. Consider the set
of orbits $M=S/P$. For $x\in M$ we have the decomposition the tangent space
\begin{equation}\label{a1}
T_xS=T_xM\oplus T_x{\cal O}_P\,,
\end{equation}
where  ${\cal O}_P $ is the orbit of $P$ containing $x$.
Let $\epsilon $ be an element of the Lie algebra $\gG$
and Pr$_P$ be the projection on the second term in (\ref{a1}).
 Impose the following condition on the vector field $\delta_\epsilon$
\begin{equation}\label{a2}
{\rm Pr}_P\delta_\epsilon(x)=0
\end{equation}
The subspace of the Lie algebra $\gG$ that satisfy this condition
is the set of the sections of the Lie algebroid ${\cal A}_M(\gG)$.
The anchor is defined by the first term in (\ref{a1}).
The commutators on the sections is the commutators of $\gG$.

In a generic case a Lie algebroid can be integrated to a global object
 - the {\em  Lie groupoid} \cite{Ba,KM,Ma,We}.
\begin{defi}
A Lie groupoid $G$ over a manifold $M$
is a pair of differential manifolds $(G,M)$,  two
differential mappings $l,r~: ~G\to M$ and a partially defined binary operation
(a product)
$(g,h)\mapsto g\cdot h $ satisfying the following conditions:\\
(i) It is defined only when $l(g)=r(h)$. \\
(ii) It is associative: $(g\cdot h)\cdot k=g\cdot (h\cdot k)$
whenever the products are defined.\\
(iii) For any $g\in G$ there exist the left and right identity elements $l_g$ and
$r_g$ such that $l_g \cdot g=g\cdot r_g=g$.\\
(iv) Each $g$ has an inverse $g^{-1}$ such that $g\cdot g^{-1}=l_g$ and
$g^{-1}\cdot g=r_g$.\\
\end{defi}
We denote an element of $g\in G$ by the triple $<< x|g|y>>$, where $x=l(g),~y=r(g)$.
Then  the product $g\cdot h $ is
$$
g\cdot h\rightarrow <<x|g\cdot h|z>>=<<x|g|y>><<y|h|z>>\,.
$$
An orbit of the groupoid in the base $M$ is defined as an equivalence
$x\sim y$ if $x=l(g),~y=r(g)$. The isotropy subgroup $G_x$ for $x\in M$ is
defined as
$$
G_x=\{g\in G~|~l(g)=x=r(g)\}\sim\{<<x|g|x>>\}\,.
$$

The Lie algebroid is a local version of the Lie groupoid. The anchor is determined in
terms of the multiplication law.
Details can be found in \cite{Ba}.


\subsection{Lie algebroid representations and Lie algebroid cohomology}

The definition of algebroids representations is rather evident:
\begin{defi}
A vector bundle representation (VBR) $(\rho, {\cal M})$ of the Lie algebroid
$\cal A$ over $M$
is a vector bundle $\cal M$ over $M$ and a map
 $\rho$ from $ {\cal A}$ to the bundle of differential operators on $\cal M$ of the order
 less or equal to $1$ $\mbox{\it Diff}^{~\le 1}({\cal M}, {\cal M})$,
 such that:\\
(i) the symbol of $\rho(\varepsilon)$ is a scalar equal to the anchor of $\varepsilon$:
$$
{\rm Symb}(\rho(\varepsilon))={\rm Id}_{\cal M}\delta_\varepsilon\,,
$$
(ii) for any $\varepsilon_1,\varepsilon_2\in\Gamma({\cal A})$
\begin{equation}\label{rep}
[\rho({\varepsilon_1}),\rho({\varepsilon_2})]=\rho({\lb\varepsilon_1\varepsilon_2\rb})\,,
\end{equation}
 where  the l.h.s. denotes
the commutator of differential operators.
\end{defi}

For example, the trivial bundle is a VBR representation (the map $\rho$
is the anchor map $\delta$),

Consider a small disk $U_{\alpha} \subset M$ with local coordinates
$x=(x_1,\ldots,x_a,\ldots)$. Then the anchor can be written as
\begin{equation}\label{5.15i}
\delta_{e^j}=b^j_a(x)\frac{\partial}{\partial x_a}=\langle b^j|\frac{\delta}{\delta  x}\rangle   \,.
\footnote{The brackets $\langle|\rangle   $ mean summations over all indices,
 taking a traces,
integrations, etc.}
\end{equation}
Let $w$ be a section of the tangent bundle $TM$. Then the VBR on
 $TM$ takes
the form
\begin{equation}\label{5.15j}
{\rho}_{e^j}w=\langle  b^j|\frac{\delta}{\delta x}w\rangle   -\langle\frac{\delta}{\delta x}b^j|w\rangle   \,.
\end{equation}
Similarly, the VBR the action of $\rho$ on a section $p$ of $T^*M$ is
\begin{equation}\label{5.16i}
\rho_{e^j}p=\frac{\delta}{\delta x}\langle  p|b^j(x)\rangle \,  .
\end{equation}
We drop a more general definition of the sheaf representation.

Now we define  cohomology groups of  algebroids.
First, we consider the case of contractible base $M$.
Let ${\cal A}^*$ be a bundle over $M$ dual to ${\cal A}$.
 Consider the bundle of graded commutative algebras
$\wedge^\bullet{\cal A}^*$.
The space $\Gamma(M, \wedge^\bullet {\cal A}^*)$
is generated by the sections $\eta_k$:
$\langle\eta_j|e^k\rangle   =\delta_j^k$. It is a graded algebra
$$
\Gamma(M, \wedge^\bullet  {\cal A}^*)=\oplus {\cal A}^*_n\,,~~
{\cal A}^*_n=\{c_n(x)=
\f1{n!}c_{j_1,\ldots,j_n}(x)\eta_{j_1}\ldots\eta_{j_n},~x\in M\}\,.
$$

 Define the Cartan-Eilenberg operator ``dual'' to the  brackets
 $\lb ,\rb$
$$
sc_n(x;e^{1},\ldots,e^{n},e^{n+1})=
(-1)^{i-1}\delta_{e^i}c_n(x;e^{1},\ldots,\hat{e}^{i},e^{n})-
$$
\begin{equation}\label{5.6}
-\sum_{j<i}
(-1)^{i+j}c_n(x;\lb e^{i},e^j\rb,\ldots,\hat{e}^{j},\ldots,\hat{e}^{i},\ldots,e^{n}).
\end{equation}
It follows from (\ref{5.1}) and AJI (\ref{5.5}) that $s^2=0$.
Thus,
$s$ determines a complex of bundles ${\cal A}^*\to \wedge^2{\cal A}^*\to \cdots$.

The cohomology groups of this complex are called {\em the cohomology groups of
algebroid with trivial coefficients}.
This complex is  a part of the BRST complex
derived below.

 The action of the coboundary operator $s$ takes the following form
 on the lower cochains:
\begin{equation}\label{5.7}
sc(x;\varepsilon)=\delta_\varepsilon c(x)\,,
\end{equation}
\begin{equation}\label{5.8}
sc(x;\varepsilon_1,\varepsilon_2)=\delta_{\varepsilon_1}c(x;\varepsilon_2)-\delta_{\varepsilon_2}c(x;\varepsilon_1)-
c(x;\lb \varepsilon_1,\varepsilon_2\rb)\,,
\end{equation}
\begin{equation}\label{5.9}
sc(x;\varepsilon_1,\varepsilon_2,\varepsilon_3)=\delta_{\varepsilon_1}c(x;\varepsilon_2,\varepsilon_3)-
\delta_{\varepsilon_2}c(x;\varepsilon_1,\varepsilon_3)
\end{equation}
$$
+\delta_{\varepsilon_3}c(x;\varepsilon_1,\varepsilon_2)
-c(x;\lb \varepsilon_1,\varepsilon_2\rb,\varepsilon_3)
+c(x;\lb \varepsilon_1,\varepsilon_3\rb,\varepsilon_2)
-c(x;\lb \varepsilon_2,\varepsilon_3\rb,\varepsilon_1)\,.
$$


It follows from (\ref{5.7}) that $H^0({\cal A},M)$  is isomorphic to the
invariants in the space $C^\infty (M)$. The next cohomology group
$H^1({\cal A},M)$ is responsible for the shift of the anchor action:
\begin{equation}\label{5.11}
\hat{\delta}_\varepsilon f(x)= \delta_\varepsilon f(x)+c(x;\varepsilon), ~~sc(x;\varepsilon)=0.
\end{equation}
If $c(x;\varepsilon)$ is a cocycle (see (\ref{5.8})), then this action is
 consistent with the defining anchor property (\ref{5.1}).
 The action (\ref{5.11}) on $\Psi=\exp f(x)$
takes the form
\begin{equation}\label{5.11a}
\hat{\delta}_{\varepsilon}\Psi=\left(\delta_\varepsilon+c(x;\varepsilon)\right)\Psi(x).
\end{equation}
This formula defines a ``new'' structure of VBR on the {\em trivial } line
bundle.
Let $\tilde{M}=M/G$ be the
set of orbits of the groupoid $G$ on its base $M$.
The condition
\begin{equation}\label{5.11b}
\hat{\delta}_{\varepsilon}\Psi=0
\end{equation}
defines a linear bundle ${\cal L}(\tilde{M})$ over $\tilde{M}$.

Two-cocycles $c(x;\varepsilon_1,\varepsilon_2)$ allow to construct
the central extensions of brackets on $\Gamma({\cal A})$
\begin{equation}\label{5.9a}
\lb(\varepsilon_1,k_{1}),(\varepsilon_2,k_{2})\rb_{c.e.}=
(\lb\varepsilon_1,\varepsilon_2\rb,c (x;\varepsilon_1,\varepsilon_2))\,.
\end{equation}
The cocycle condition (\ref{5.9}) means that the new brackets
$\lb~,~\rb_{c.e.}$ satisfies AJI (\ref{5.5}).
The exact cocycles leads to the splitted extensions.

If $M$ is not contractible the definition of cohomology group is more
complicated. We sketch the \^{C}ech version of it.
Choose an acyclic covering $U_\alpha$. Consider the \^{C}ech
complex with coefficients in $\bigwedge{}^{\bullet}({\cal A}^{*})$
corresponding to this covering:
$$\bigoplus \Gamma (U_\alpha ,\bigwedge{}^{\bullet}({\cal
A}^{*}))
\stackrel{d}{\longrightarrow}
\bigoplus\Gamma (U_{\alpha\beta },\bigwedge{}^{\bullet}({\cal
A}^{*}))
\stackrel{d}{\longrightarrow}\cdots$$
The \^{C}ech differential $d$ commutes with  the Cartan-Eilenberg operator
$s$, and cohomology of algebroid are cohomology of normalization of this
bicomplex~:
$$\bigoplus \Gamma (U_\alpha ,{\cal
A}^{*}_0)
\stackrel{d,s}{\longrightarrow}
\bigoplus\Gamma (U_{\alpha\beta },{\cal
A}^{*}_0)
\oplus
\bigoplus \Gamma (U_\alpha ,{\cal
A}^{*}_1)
\stackrel{
\left(\begin{array}{ccc}
d&s&\\
&-d&s
\end{array}\right)
}{\longrightarrow}$$
$$
\bigoplus\Gamma (U_{\alpha\beta\gamma },{\cal
A}^{*}_0)
\oplus
\bigoplus \Gamma (U_{\alpha\beta} ,{\cal
A}^{*}_1)
\oplus
\bigoplus \Gamma (U_\alpha ,{\cal
A}^{*}_2)\longrightarrow \cdots\,.
$$
The cochains
 $c^{i,j}\in\bigoplus_{\alpha_{1}\alpha_{2}\cdots \alpha_j}
\Gamma (U_{\alpha_{1}\alpha_{2}\cdots \alpha_j} ,{\cal
A}^{*}_i)$ are bigraded. The differential maps $c^{i,j}$ to $(-1)^jd\,c^{i,j}+sc^{i,j}$,
 has type $(i,j+1)$ for $(-1)^jd\,c^{i,j}$ and $(i+1,j)$ for $sc^{i,j}$.


Again, the group $H^0({\cal A},M)$  is isomorphic to the
invariants in the whole space $C^\infty (M)$.

Consider the next group $H^{(1)}({\cal A},M)$.
It has  two components\\ $(c_\alpha(x,\varepsilon),c_{\alpha\beta}(x))$.
They are characterized by the following conditions (see (\ref{5.8}))
 $$
c_\alpha(x;\lb \varepsilon_1,\varepsilon_2\rb)=
\delta_{\varepsilon_1}c_\alpha(x;\varepsilon_2)-\delta_{\varepsilon_2}c_\alpha(x;\varepsilon_1)\,,
$$
\begin{equation}\label{ch1}
  \delta_{\varepsilon}c_{\alpha\beta}(x)=-c_\alpha(x;\varepsilon)+c_\beta(x;\varepsilon)\,,
\end{equation}
\begin{equation}\label{ch2}
 c_{\alpha\gamma}(x)=c_{\alpha\beta}(x)+c_{\beta\gamma}(x)\,.
\end{equation}
While the first component  $c_\alpha(x,\varepsilon)$ comes from the algebroid action
on $U_\alpha$ and define the action of the algebroid on the trivial bundle
(\ref{5.11a}), the second
component  determines a line bundle ${\cal L}$ on $M$ by the transition functions
$\exp (c_{\alpha\beta})$. The condition (\ref{ch1}) shows that the actions on
the restriction to $U_{\alpha\beta}$ are compatible.


The continuation of the central extension (\ref{5.9a}) from $U_\alpha$ on $M$ is defined now
by $H^{(2)}({\cal A},M)$.
There is an obstacle to this continuations in $H^{(3)}({\cal A},M)$.
We do not dwell on this point.


\subsection{Hamiltonian algebroids}

We modify the notion of the Lie algebroids in the following way.
Let ${\cal R}$ be a Poisson manifold.
 Any smooth function $h\in C^\infty({\cal R})$
 gives rise to a vector field
$$
\delta_{h} x=\{x,h\}\,.
$$
The space $C^\infty({\cal R})$ has
the structure of a Lie algebra with respect to the Poisson brackets.
In what follows we assume that ${\cal R}$ is a symplectic manifold with
the symplectic form $\omega$. In this case the Poisson brackets
$$
\{h_1,h_2\}=-i_{h_1}dh_2\,.
$$
are defined by the internal derivation $i_h$ of
the symplectic form $i_h\omega=d h$.

Let ${\cal A}^H$ be a vector bundle over ${\cal R}$ and
assume that the space of sections $\Gamma({\cal A}^H)$ is equipped by
 the Lie brackets $\lb\varepsilon_1,\varepsilon_2\rb$.
\begin{defi}
${\cal A}^H$ is a {\em Hamiltonian  algebroid} over a Poisson
manifold ${\cal R}$ if there exists
a bundle map from ${\cal A}^H$ to the Lie algebra
on $C^\infty({\cal R})$: $\varepsilon\to h_\varepsilon$, (i.e. $f\varepsilon\to fh_\varepsilon$ for
$f\in C^\infty({\cal R})$)
satisfying the following conditions:\\
(i) For any $\varepsilon_1,\varepsilon_2\in\Gamma ({\cal A}^H)$
\begin{equation}\label{5.12}
\{ h_{\varepsilon_1},h_{\varepsilon_2}\}=h_{\lb\varepsilon_1,\varepsilon_2 \rb}\,.
\end{equation}\\
(ii) For any $\varepsilon_1,\varepsilon_2\in\Gamma ({\cal A}^H)$ and $f\in C^\infty({\cal R})$
$$
\lb\varepsilon_1,f\varepsilon_2\rb=f\lb\varepsilon_1,\varepsilon_2\rb+\{h_{\varepsilon_1},f\}\varepsilon_2\,.
$$
\end {defi}
The both conditions are similar to the defining properties of the
Lie algebroids (\ref{5.1}),(\ref{5.2}).
\begin{rem}
In contrast with the Lie algebroids with the anchor $\delta_\varepsilon$, that is a
bundle map:
$f\varepsilon\to f\delta_\varepsilon$,
 for the Hamiltonian algebroids
one has the map to the first order differential operators with respect to $f$
$$
f\varepsilon\to f\delta_{h_\varepsilon}+h_\varepsilon\delta_f\,.
$$
\end{rem}

Let $f^{jk}_i$ be structure functions of a Hamiltonian algebroid  and
$$
C_n^{j,k,m}=f^{jk}_i(x)f_n^{im}(x)+\{h_{e^m},f^{jk}_n(x)\}+{\rm c.p.}(j,k,m)\,.
$$
Then the Jacobi identity for the Poisson brackets implies
\begin{equation}\label{5.13a}
C_n^{j,k,m}h_{\varepsilon^n}=0\,.
\end{equation}
This identity is similar to (\ref{5.3}) for Lie algebroids.
But now one can add to $C_n^{j,k,m}$  the term proportional to
$E^{j,k,m}_{[ln]}h_{\varepsilon^l}$ without the breaking (\ref{5.13a})
(here $[,]$ means the antisymmetrization).
Thus, the Jacobi identity for the Poisson algebra of Hamiltonians leads
to following identity for the structure functions
\begin{equation}\label{5.14}
f^{jk}_i(x)f_n^{im}(x)+\{h_{e^m},f^{jk}_n(x)\}+
E^{j,k,m}_{[ln]}h_{\varepsilon^l}+c.p.(j,k,m)=0\,.
\end{equation}
This structure arises in the Hamiltonian systems with the first class constraints
\cite{Ba} and leads to the so-called open algebra of an arbitrary rank (see \cite{HT,BFV}).

The important particular case
\begin{equation}\label{5.15}
f^{jk}_i(x)f_n^{im}(x)+\{H_{\varepsilon^m}f^{jk}_n(x)\}+c.p.(j,k,m)=0
\end{equation}
corresponds to the open algebra of rank one similar to the
Lie algebroid (\ref{5.5}). We will call (\ref{5.15}) a simple anomalous
Jacobi identity (SAJI) preserving the notion AJI for the general form (\ref{5.14}).
In this case the Hamiltonian algebroid can be integrated to the Hamiltonian groupoid.
The later is the Lie groupoid with the canonical action
with respect to the symplectic form on the base ${\cal R}$.


\subsection{Symplectic affine bundles over cotangent bundles}

We shall define Hamiltonian algebroids over cotangent bundles which
are a special class of symplectic manifold. There exist a slightly more general
symplectic manifolds than cotangent bundles, that we include in our
scheme. It is  an affinization over a cotangent bundle we are going to
define. Let $M$ be a vector space and ${\cal R}$ is a set with an action of
$M$ on ${\cal R}$
$$
{\cal R}\times M\rightarrow {\cal R}:(x,v)\to x+v\in {\cal R}\,.
$$
\begin{defi}
The set ${\cal R}$ is an {\sl affinization} over $M$ (a {\em  principle homogeneous
space} over $M$) ${\cal R}/M$ if the action of $M$ on  ${\cal R}$ is transitive
and exact.
\end{defi}
In other words, for any pair $x_1,x_2\in{\cal R}$ there exists $v\in M$ such that
$x_1+v=x_2$, and $x_1+v\neq x_2$ if $v\neq 0$.

This construction is generalized on bundles. Let $E$ be a bundle over $M$ and
$\Gamma(U,E)$ be the linear space of sections in a trivialization of $E$ over some
 disk $U$.
\begin{defi}
{\em An affinization} ${\cal R}/E$ of  $E$
 is a bundle over $M$ with the space of
local sections $\Gamma(U,{\cal R})$ defined as the affinization over $\Gamma(U,E)$.
\end{defi}
Two affinizations ${\cal R}_1/E$ and ${\cal R}_2/E$ are equivalent if there
exists a bundle map compatible with the action of the corresponding vector bundles.
It can be proved that non-equivalent affinizations are classified by $H^1(M,\Gamma(E))$.

Let $E=T^*M$.
Consider a linear bundle ${\cal L}$ over $M$. The space of connections
Conn$_M({\cal L})$ can be identified with the space of sections
${\cal R}/T^*M$. In fact, for any
connection $\nabla_x, ~x\in U\subset M$ one can define another connection
$\nabla_x+\xi,~\xi\in \Gamma(T^*M)$. The affinization ${\cal R}/T^*M$ can be classified by
the first Chern class $c_1({\cal L})$. The trivial bundles correspond to
$T^*M$.

The affinization ${\cal R}/T^*M$ is
the symplectic space with the canonical form $\langle  dp\wedge dx\rangle   $. In contrast with $T^*M$
this form is not exact, since $pdx$ is defined only locally.
In the similar way as for $T^*M$,
the space of square integrable sections $L^2(\Gamma({\cal L}))$ plays the role of
the Hilbert space in the prequantization of the affinization ${\cal R}/T^*M$.
For $f\in{\cal R}$ define the Hamiltonian vector field $\alpha_f$ and the
covariant derivative $\nabla(f)_x=i_{\alpha_f}\nabla_x $   along $\alpha_f$.
Then the prequantization of ${\cal R}/T^*M$ is determined by the operators
$$
\rho(f)=\f1{i}\nabla(f)_x+f
$$
acting on the space $L^2(\Gamma({\cal L}))$. In particular,
$\rho(p)=\f1{i}\frac{\delta}{\delta x}$,
$\rho(x)=x$.

The basic example, though for infinite-dimensional spaces, is the affinizations over
the antiHiggs bundles.
\footnote{We use the antiHiggs bundles instead of the standard Higgs bundles for
reasons, that will become clear in Sect. 4.}
The antiHiggs bundle ${\cal H}_N(\Sigma)$ is a cotangent bundle to the space
of connections $\nabla^{(1,0)}=\partial+A$ in a vector bundle of rank $N$
over a Riemann curve
$\Sigma$. The cotangent vector (the antiHiggs field) is $\sln$ valued $(0,1)$-form
$\bar{\Phi}$. The symplectic form on ${\cal H}_N(\Sigma)$ is\\
$-\int_\Sigma{\rm tr}(d\bar{\Phi}\wedge dA)$.
The affinizations ${\cal R}^{(\kappa)}/{\cal H}_N(\Sigma)$
are the space of connections \\$(\kappa\bar{\partial}+\bar{A},\partial+A)$ with the
symplectic form $\int_\Sigma{\rm tr}(dA\wedge d\bar{A})$, where $\kappa$ parameterizes the
affinizations. The elements of the space Conn$_{(\partial+A)}({\cal L})$
giving rise to   ${\cal R}^{(\kappa)}_{{\rm SL}(N)}/{\cal H}_N(\Sigma)$ are
\begin{equation}\label{na}
\nabla \Psi=\frac{\delta \Psi}{\delta A}+\kappa \bar{A}\Psi\,.
\end{equation}


\subsection{Hamiltonian algebroids related to Lie algebroids}

Now we are ready to introduce an important subclass of Hamiltonian algebroids.
They are extensions of the Lie algebroids and share with them
SAJI (\ref {5.15}).

\begin{lem}
The anchor action (\ref{5.15i}) of the Lie algebroid ${\cal A}$ over $M$
can be lifted to the Hamiltonian action on ${\cal R}/T^*M$
 such that it defines the Hamiltonian algebroid ${\cal A}^H$ over ${\cal R}$.
The equivalence classes of these lifts
are isomorphic to $H^1({\cal A},M)$.
\end{lem}
{\sl Proof}.
Consider a small disk $U_\alpha\subset M$. The anchor (\ref{5.11}) has the form
\begin{equation}\label{5.15a}
\hat{\delta}_{e^j}=\langle  b^j|\frac{\delta}{\delta  x}\rangle   +c(x;e^j)\,.
\end{equation}
Next, continue the action on ${\cal R}/T^*U_\alpha$.
We represent the affinization
as the space \\
Conn\,${\cal L}(M)=\{\nabla^p=\frac{\delta}{\delta  x}+p\,,~~ x\in U_\alpha\,,
~~p\in T^*M \}$.
Since ${\cal L}$ on $U_{\alpha}$ is trivialized we can identify the connections
with one-forms $p$.
Let $w\in TM$ and
$$
\nabla^p_w\Psi:=i_w\nabla^p\Psi=
\langle w|\frac{\delta\Psi}{\delta x}\rangle+\langle  w|p\rangle\Psi
$$
be the covariant derivative along $w$.
 To lift the action we use the
Leibniz
rule for the anchor action on the covariant derivatives:
$$
\hat\delta_{e^j}(\nabla^p)_\alpha\Psi=\hat\delta_{e^j}(\nabla^p_\alpha\Psi)-
\nabla^p_\alpha\hat\delta_{e^j}\Psi-\nabla^p_{\hat\delta_{e^j}\alpha}\Psi\,.
$$
It follows from (\ref{5.16i}) and (\ref{5.15a}) that
\begin{equation}\label{5.16a}
\hat{\delta}_{e^j}p=-\frac{\delta}{\delta x}\langle p|b^j(x)\rangle-\frac{\delta}{\delta x}c(x;e^j)\,.
\end{equation}
Note that the second term is responsible for the pass from $T^*M$ to
the affinization ${\cal R}$, otherwise $p$ is transformed as a cotangent vector
(see (\ref{5.15i})).

The vector fields (\ref{5.15a}) are hamiltonian
 with respect
to the canonical symplectic form $\langle  dp|dx\rangle   $ on ${\cal R}$.
The corresponding  Hamiltonians have the linear dependence on ""momenta"":
\begin{equation}\label{5.17}
h^j=\langle p|b^j(x)\rangle   +c^j(x)\,.
\end{equation}
Note that $h^j$ satisfies the Hamiltonian algebroid
property (\ref{5.12}), since $sc^j(x)=0$ (\ref{5.8}).

We have constructed the Hamiltonians locally and want to prove that this definition
is compatible with gluing
$U_\alpha$ and $U_\beta$. Note, that when we glue  ${\cal R}|_{U_\alpha}$
 and ${\cal R}|_{U_\beta}$
we shift fibers by $\frac{\delta c_{\alpha\beta}}{\delta x}$~:
$p_\alpha=p_{\beta}+ \frac{\delta c_{\alpha\beta}}{\delta x}$. Indeed,
 we glue the bundle ${\cal L}(M)$
restricted on $U_{\alpha\beta}$ by multiplication on  $\exp  c_{\alpha\beta}(x)$.
The connections are
transformed
by adding the logarithmic derivative of the transition functions.
On the other hand, $ \delta_{\varepsilon}c_{\alpha\beta}(x)=-c_\alpha(x;\varepsilon)+c_\beta(x;\varepsilon)$
(see (\ref{ch1})). So
$$
h_\alpha^j=\langle p_\alpha|b^j(x)\rangle   +c_\alpha^j(x)=\langle p_{\beta}+
 \frac{\delta c_{\alpha\beta}}{\delta x}|b^j(x)\rangle
 -\delta_{\varepsilon}c_{\alpha\beta}^j(x)+c_\beta^j(x;\varepsilon)
 $$
$$
=\langle p_\beta|b^j(x)\rangle   +c_\beta^j(x)=h_\beta^j\,,
$$
and the Hamiltonians become defined globally.

The exact cocycle $c_\alpha^j(x)=\delta_{e^j}f_\alpha(x)$
shifts the momenta
$h^j=\langle p_\alpha+\frac{\delta f_\alpha(x)}{\delta x}|b^j(x)\rangle$.


We rewrite the canonical transformations in the form
$$
\hat{\delta}_{e^j}\Phi(p,x)=\delta_{e^j}\Phi(p,x)+
\langle f^j|\frac{\delta\Phi(p,x)}{\delta p}\rangle\,,~~
f^j=-\langle p|\frac{\delta b^j(x)}{\delta x}\rangle   -\frac{\delta c^j(x)}{\delta x}\,.
$$
Thus, all nonequivalent
lifts of anchors from $M$ to ${\cal R}/T^*M$ are in one-to-one correspondence
with $H^1({\cal A},M)$.
Thereby, we have constructed the Hamiltonian
algebroid ${\cal A}^H$ over the principle homogeneous  space ${\cal R}$.
It has the same fibers and
the same structure functions $f^{jk}_i(x)$ as the underlying Lie algebroid ${\cal A}$
over $M$ and the bundle map $e^j\to h^j$ (\ref{5.17}).
$\Box$

\bigskip
Now investigate AJI (\ref{5.14}) in this particular case.
\begin{lem}
The Hamiltonian algebroids  ${\cal A}^H$ have the SAJI (\ref{5.15}).
\end{lem}
{\sl Proof}.

First note that the Lie algebroids we started with have the
SAJI (\ref{5.5}). The Hamiltonian algebroids
${\cal A}^H$ have the same structure functions
$f^{jk}_i(x)$ depending on coordinates on $M$ only. Consider
the general AJI (\ref{5.14}). It follows from (\ref{5.17})
that
$$
\{h^j,f^{nk}_i(x)\}=\langle b^j|\frac{\delta f^{nk}_i(x)}{\delta  x}\rangle   =
\delta_{e^j}f^{nk}_i(x)\,.
$$
The sum of the first two terms in (\ref{5.14}) coincides with
the SAJI (\ref{5.15}) in the underlying Lie algebroid ${\cal A}$, and therefore vanishes.
$\Box$


\subsection{Reduced phase space and its BRST description}

In what follows we shall consider Hamiltonian algebroids related to
Lie algebroids. Let $e^j$ be a basis of sections in $\Gamma({\cal A}^H)$.
Then the Hamiltonians (\ref{5.17}) can be represented in the form
$h^j=\langle e^j|F(x)\rangle   $, where $F(x)\in\Gamma(({\cal A}^{H})^*)$ defines the {\em moment map}
$$
m: {\cal R}\rightarrow\Gamma(({\cal A}^{H})^*)\,,~~m(x)=F(x)\,.
$$
The coadjoint action ${\rm ad}^*_{\varepsilon}$ in $\Gamma(({\cal A}^{H})^*)$ is defined
in the usual way
$$
\langle \lb\varepsilon, e^j\rb|F(x)\rangle   =\langle e^j|{\rm ad}^*_{\varepsilon}F(x)\rangle \,  .
$$
One can fix a moment  $F(x)=m_0$ in $\Gamma(({\cal A}^{H})^*)$.
 The reduced phase space is defined as the quotient
$$
{\cal R}^{red}=\{x\in {\cal R}|(F(x)=m_0)/G_0\}\,,
$$
where $G_0$ is  generated by the  transformations
${\rm ad}^*_\varepsilon$ such that ${\rm ad}^*_\varepsilon m_0=0$. In other words, ${\cal R}^{red}$
is the set of orbits of $G_0$ on the constraint surface $F(x)=m_0$.
The symplectic form $\omega$ being restricted on $R^{red}$ is non-degenerate.

The BRST approach allows us to go around the reduction procedure by introducing
additional fields (the ghosts).
We shall construct the BRST complex for ${\cal A}^{H}$ in a similar way as the
Cartan-Eilenberg complex for the Lie algebroid ${\cal A}$. The BRST complex
is endowed with a Poisson structure and it
allows us to define the nilpotent BRST operator.

 Consider the dual bundle $({\cal A}^{H})^*$.
Its  sections $\eta \in\Gamma(({\cal A}^{H})^*)$ are the anti-commuting (odd) fields called
 {\em the ghosts}.
Let $h_{e^j}=\langle \eta_j|F(x)\rangle$, where $\{\eta_j\}$ is a basis in
$\Gamma(({\cal A}^{H})^*)$ and $F(x)=0$ are the moment constraints, generating the
canonical algebroid action on ${\cal R}$.
 Introduce another type of odd variables ({\em the ghost momenta})
${\cal P}^j,~j=1,2,\ldots$ dual to the ghosts $\eta_k,~k=1,2,\ldots$
${\cal P}\in \Gamma({\cal A}^{H})$.
 We attribute the ghost
 number one to the ghost fields gh$(\eta)=1$, minus one to the ghost momenta
gh$({\cal P})=-1$ and gh$(x)=0$ for $x\in {\cal R}$.
Introduce
the Poisson brackets in addition to the non-degenerate Poisson structure on ${\cal R}$
\begin{equation}\label{5.19}
\{\eta_j,{\cal P}^k\}=\delta_j^k\,,~~\{\eta^j,x\}=\{{\cal P}_k,x\}=0\,.
\end{equation}
Thus, all fields are incorporated in the graded Poisson superalgebra
$$
{\cal BFV}=\left(
\Gamma(\wedge^\bullet  (({\cal A}^{H})^*\oplus{\cal A}^{H})
\right)\otimes C^\infty({\cal R})
=\Gamma(\wedge^\bullet ({\cal A}^{H})^*)
\otimes\Gamma(\wedge^\bullet {\cal A}^{H})\otimes C^\infty({\cal R})\,.
$$
({\em the Batalin-Fradkin-Volkovitsky (BFV) algebra}).

There exists a nilpotent operator $Q$ on the BFV algebra $Q^2=0,~gh(Q)=1$
({\em the BRST operator}) transforming ${\cal BFV}$ into the BRST complex.
The cohomology of the BRST complex give rise to the structure of
the classical reduced phase space ${\cal R}^{red}$. In some cases\\
$H^j(Q)=0,~j>0$ and $H^0(Q)=$ classical observables.

Represent the action of $Q$ as the Poisson brackets:
$$
Q\psi=\{\psi,\Omega\},~~\psi,\Omega\in {\cal BFV}\,.
$$
Due to the Jacobi identity for the Poisson brackets the nilpotency of $Q$
is equivalent to
$\{\Omega,\Omega\}=0$.
Since $\Omega$ is odd, the brackets are symmetric.
 For generic Hamiltonian algebroid $\Omega$
 can be represented as the expansion \cite{HT}
$$
\Omega=h_\eta+\frac{1}{2}\langle \lb\eta,\eta'\rb|{\cal P}\rangle   +...\,,~(h_\eta=\langle \eta|F\rangle   )\,,
$$
where the higher order terms in ${\cal P}$ are omitted.
The highest order of ${\cal P}$
in $\Omega$ is called {\em the rank} of the BRST operator $Q$.
If ${\cal A}$ is a Lie algebra defined along with its canonical
action on ${\cal R}$ then $Q$ has the rank one or less. In this case
the BRST operator $Q$ is the extension of the Cartan-Eilenberg operator
giving rise to the cohomology of ${\cal A}$ with coefficients in
$C^\infty({\cal R})$. Due to the Jacobi identity
the first two terms in the previous expression provide
the nilpotency of $Q$. It turns out that for the Hamiltonian algebroids ${\cal A}^H$
$\Omega$ has the same structure as for  the Lie algebras
 though the Jacobi identity has additional terms.
\begin{theor}
The BRST operator $Q$ for the Hamiltonian algebroid ${\cal A}^{H}$
has the rank one:
\begin{equation}\label{5.20}
\Omega=\langle \eta|F\rangle   +\frac{1}{2}\langle \lb\eta,\eta'\rb|{\cal P}\rangle \,.
\end{equation}
\end{theor}
{\sl Proof}.\\
 Straightforward  calculations show that
$$
\{\Omega,\Omega\}=
\{h_{\eta_1},h_{\eta_2}\}+\frac{1}{2}\langle \lb\eta_2,\eta_2'\rb|F\rangle
-\frac{1}{2}\langle \lb\eta_1,\eta_1'\rb|F\rangle
$$
$$
+\frac{1}{2}\{h_{\eta_1},\langle \lb\eta_2\eta_2'\rb|{\cal P}_2\rangle   \}
-\frac{1}{2}\{h_{\eta_2},\langle \lb\eta_1,\eta_1'\rb|{\cal P}_1\rangle   \}+
\f1{4}\{\langle \lb\eta_1,\eta_1'\rb|{\cal P}_1\rangle,\langle \lb\eta_2,\eta_2'\rb|{\cal P}_2\rangle\}\,.
$$
The sum of the first three terms vanishes due to (\ref{5.12}).
The sum of the rest terms is the left hand side of the SAJI (\ref{5.15}).
The additional dangerous term may come from the Poisson brackets of
the structure functions
$\{\lb\eta_1,\eta_1'\rb,\lb\eta_2,\eta_2'\rb\}$. In fact, these
brackets vanish because the structure functions
do not depend
on the ghost momenta. Thus, the SAJI leads to the desired identity $\{\Omega,\Omega\}=0$.
$\Box$

\section{Hamiltonian algebroids and Poisson sigma-model}
\setcounter{equation}{0}

\subsection{Cotangent bundles to Poisson manifolds
as Lie algebroids}

Let $M$ be a Poisson manifold with Poisson bivector $\pi=\pi(\varepsilon,\varepsilon')$,
where    $\varepsilon,\varepsilon'$ are section of the bundle $T^*M$.
It is a skewsymmetric tensor, with the vanishing Schouten brackets (the Jacobi identity)
$[\pi,\pi]_S=0$. It means
in local coordinates $x=(x_1,\ldots,x_n)$
\begin{equation}\label{2.1}
\partial_i\pi^{jk}(x)\pi^{im}(x)+{\rm c.p.}(j,k,m)=0\,.
\end{equation}

The Poisson brackets are defined on the space of smooth functions
${\cal H}(M)$
$$
\{f(x),g(x)\}:=\langle df|\pi| dg\rangle,~~df,dg\in T^*_xM\,.
$$
The Poisson bivector gives rise to  the  map
\begin{equation}\label{2.2a}
V^\pi:T^*M\to TM\,,~~
V^\pi_\varepsilon=\langle\varepsilon|\pi|\partial\rangle\,.
\end{equation}
The corresponding Lie derivative ${\cal L}_{V_\varepsilon}:=\delta_\varepsilon$
acts as
\begin{equation}\label{dx}
\delta_\varepsilon x=\pi(x)|\varepsilon\rangle\,.
\end{equation}
In this way we obtain a map from the space of smooth functionals ${\cal H}(M)$
 to the space of the Hamiltonian vector fields $\Gamma^H(TM)=\{V^\pi_\varepsilon\}$
\begin{equation}\label{2.2}
f\to V_f= \langle df|\pi|\partial\rangle\,.
\end{equation}
The Poisson brackets  can be rewritten as
$\{f(x),g(x)\}=-i_{V_{df}}dg$.

One can define the brackets on the one-forms $\varepsilon,\varepsilon'\in\Gamma(T^*M)$
\begin{equation}\label{2.3}
\lb\varepsilon,\varepsilon'\rb=d\langle\varepsilon|\pi(x)|\varepsilon'\rangle+\langle d\varepsilon|\pi|\varepsilon'\rangle
+\langle\varepsilon|\pi|d\varepsilon'\rangle\,.
\end{equation}

\begin{lem}
$T^*M$ is a Lie algebroid ${\cal A}$ over the Poisson manifold $M$
with the Lie brackets (\ref{2.3}) and the anchor (\ref{2.2a}).
\end{lem}
{\sl Proof.}


It follows from the Jacobi identity (\ref{2.1}), that
the brackets (\ref{2.3}) is the Lie brackets and the
commutator of the vector fields  satisfies (\ref{5.1})
\begin{equation}\label{2.3a}
[ V_\varepsilon,V_{\varepsilon'}]=V_{\lb\varepsilon,\varepsilon'\rb}\,.
\end{equation}
The property
(\ref{5.2}) follows from the definition of Lie brackets (\ref{2.3}).
$\Box$

\bigskip

The structure functions  of $T^*M$  is defined by the Poisson bivector
$$
f^{jk}_i(x)=\partial_i\pi^{jk}(x)\,.
$$
This type of Lie algebroids was introduced in
Ref.~\cite{Ka},\cite{Fu}.

\begin{rem}
A linear space $M$ with the linear Poisson brackets $\pi^{jk}(x)=f^{jk}_ix^i$
can be identified with a Lie coalgebra $\gG^*$.
 Then the Hamiltonian vector field coming from the anchor $V^\pi$
is just the coadjoint action
\begin{equation}\label{co}
V^\pi_\varepsilon\sim{\rm ad}^*_\varepsilon \,.
\end{equation}
\end{rem}

Consider a punctured
 disk $D^*=|z|\le 1$ and the space of the meromorphic maps\\
${\bf M} = \{X:D^*\to M,~X=X((z,z^{-1}))\}$.
Define the Lie algebroid ${\cal A}_{\bf M}$ over the space
${\bf M}$ with the brackets (\ref{2.3}) on  the sections of $X^*(T^*M)$.
For simplicity we do not change the notion of the anchor action
\begin{equation}\label{7.4b}
\delta_\varepsilon X=\pi(X)|\varepsilon\rangle\,.
\end{equation}



\subsection{Poisson sigma-model and Hamiltonian algebroids}

The Poisson sigma-model is a way to construct a Hamiltonian
algebroid related to the Lie algebroid  ${\cal A}_\bfM$.
The manifold $M$ serves as the target space for the Poisson sigma model.
The space-time  is the disk $D^*$.

Consider  the one-form $\xi$ on $D^*$ taking values in the pull-back by
$X$ of the cotangent bundle $T^*M$, or the affinization over $T^*M$.
Endow the space of fields $(X,\xi)$ with
the canonical symplectic form
\begin{equation}\label{7.2a}
\omega=\f1{2\pi}\oint\langle D X \we D\xi \rangle.
\end{equation}

The canonical transformations of $\omega$  is
represented by (\ref{7.4b}) and according with (\ref{5.16a}) by
\begin{equation}\label{7.5}
\hat{\delta}_\varepsilon\xi=\frac{\delta}{\delta X}c(X,\varepsilon)
+\langle \varepsilon|\frac{\delta}{\delta X}\pi|\xi\rangle=
-\bar{\partial}\epsilon+\langle\varepsilon|\frac{\delta}{\delta X}\pi|\xi\rangle\,,
\end{equation}
where  $c(X,\varepsilon)$ is the anti-holomorphic one-cocycle  from $H^1({\cal A},\bfM)$
\begin{equation}\label{7.7}
c(X,\varepsilon)=-\f1{2\pi}\oint\langle\varepsilon|\bar{\partial} X\rangle\,.
\end{equation}
These transformations are generated by the first class constraints
 \begin{equation}\label{7.3}
F:=\bar{\partial} X+\pi(X)|\xi\rangle=0\,.
\end{equation}

The action (\ref{7.5}) amounts to the lift of the anchor action from $\bfM$
to
the affinization ${\cal R}/T^*\bfM$ over $T^*\bfM$
 by means of the cocycle (\ref{7.7}) in accordance with Lemma 2.1.
The canonical transformations of a smooth functionals on ${\cal R}$
 are the Hamiltonian transformation
\begin{equation}\label{anc}
\hat{\delta}_{\varepsilon} f(X,\xi)=\{h_{\varepsilon},f(X,\xi)\}\,.
\end{equation}
Here the Poisson brackets are inverse to the symplectic form $\omega$
(\ref{7.2a})
and
\begin{equation}\label{7.8}
h_{\varepsilon}=\oint\langle\varepsilon| F\rangle\,.
\end{equation}
(see (\ref{5.17})).
Again, due to the cocycle property,
$\{h_\varepsilon,h_{\varepsilon '}\}=h_{\lb\varepsilon,\varepsilon '\rb}$.

Summarizing, we have defined the symplectic manifold
 ${\cal R}\{\xi,X\}$
and the Hamiltonian algebroid
${\cal A}^H_{\cal R}$ over ${\cal R}$ with the sections
$\varepsilon\in\Gamma({\cal A}^H_{\cal R})$ and the anchor (\ref{anc}),(\ref{7.8}).

Following our approach we interpret the constraints  (\ref{7.3}) as the consistency
conditions for a linear system.
Let $\psi_1,\psi_2$ be sections of $X^*(T^*M)$ and $X^*(TM)$
correspondingly, and $B$ is a family of the linear maps
$X^*(T^*M)$ to $X^*(TM)$
\begin{equation}\label{7.4c}
B(X)=\lambda+\pi (X)\,,~~B(X)\psi_1=\psi_2\,.
\end{equation}
Consider the linear system
\begin{equation}\label{7.4a}
B(X)\psi_1=0\,.
\end{equation}
The second equation is
\begin{equation}\label{7.5a}
A^*\psi_1=0\,,
\end{equation}
where $A$ is the linear map
$A:X^*(T^*M)\to X^*(T^*M)$
\begin{equation}\label{7.5c}
A=-\bar{\partial}+|\frac{\delta}{\delta X}\pi|\xi\rangle\,,
\end{equation}
and $A^*:X^*(TM)\to X^*(TM)$
$$
A^*=-\bar{\partial}-|\frac{\delta}{\delta X}\pi|\xi\rangle\,.
$$
\begin{lem}
Let the Poisson bivector satisfies the non-degeneracy condition:\\
 the matrix $a_i^j=(\frac{\delta}{\delta X^i}\pi ^{jm}$ is non-degenerate
on $M$ for some $m$.\\
 Then the constraints  (\ref{7.3}) are the consistency
conditions for (\ref{7.4a}) and (\ref{7.5a}).
\end{lem}
{\sl Proof.}
The consistency condition of these equations is the operator equation
$$
BA-A^*B=0.
$$
After substitution in it the expressions for $A,A^*,B$ and applying the Jacobi identity
(\ref{2.1}) one comes to the equality
$$
(\bar{\partial} X^j+\pi^{is}\xi_s)\partial_i\pi^{jm}(\psi_1)_m=0.
$$
The later is equivalent to the constraint equation (\ref{7.3}) if $\pi$ is
non-degenerate in the above sense. $\Box$

\subsection{BRST construction}

Consider a smooth functional  $\Psi(X)$ on $\bfM$
annihilating by the anchor action
\begin{equation}\label{LB}
\hat{\delta}_{\varepsilon}\Psi(X):=\f1{2\pi}\oint\langle\varepsilon|
\pi(X)d\Psi(X)\rangle+
\left(\f1{2\pi}\oint\langle\varepsilon|\bar{\partial} X\rangle
\right)\Psi(X)=0.
\end{equation}
Let $G$ be the Lie groupoid corresponding to the Lie algebroid ${\cal A}_\bfM$.
Consider the space of orbits $\tilde{\bfM}=\bfM/G$
and the line bundle ${\cal L}(\tilde{\bfM})$ over
$\tilde{\bfM}$ with
 the space of sections $\Gamma({\cal L})=\{\Psi(X)\}$ (\ref{LB}).
The Hilbert space $L^2(\Gamma({\cal L}))$ arises in the prequantization
of the symplectic quotient\\
${\cal R}^{red}={\cal R}//G^H=\{F=0\}/G^H$,
where $G^H$ is the Hamiltonian groupoid.

The quantization of ${\cal R}^{red}$ can be performed by the BRST technique.
The classical BRST complex is the set of fields
$$
\bigwedge{}^\bullet\left
(\Gamma(X^*(TM))
\oplus\Gamma(X^*(T^*M))
\right)\otimes C^\infty({\cal R})\,,
$$
where the first component is the space of sections of the anticommuting
variables $\eta$ dual to the gauge generators $\varepsilon$, the second component
is the space of their momenta ${\cal P}$.
Theorem 2.1 states that the BRST operator has the rank one
$$
\Omega=\f1{2\pi}\oint\langle\eta |F\rangle+
\f1{\pi}\oint\langle\lb\eta,\eta\rb|{\cal P}\rangle\,.
$$
It means that the nonlinear deformation of the Poisson bivector on $M$
does not affect the Lie algebraic form of $\Omega$.
This form of $\Omega$ for the Poisson sigma model
was established in \cite {SS}.


\section{Two examples of Hamiltonian algebroids with
Lie algebra symmetries}
\setcounter{equation}{0}

In this section we consider two examples, where the spaces of sections
of the Hamiltonian
algebroids are just  Lie algebras of hamiltonian
vector fields and therefore the symmetries are the standard Lie
symmetries.
Nevertheless, they are in much the same
as in the  algebroid cases.
In both examples we cast the known constructions in the form suitable
to our approach.

Let $\Sigma_{g,n}$ be a Riemann curve of
 genus $g$
with $n$ marked points. The first examples is the moduli
space of flat bundles over $\Sigma_{g,n}$. It will become clear later,
that it is
an universal system containing hidden algebroid symmetries.
 The second example is
the projective structures (${\cal W}_2$-structures) on $\Sigma_{g,n}$.
Their generalization is the ${\cal W}_N$-structures, where
the symmetries are
defined by a nontrivial Hamiltonian  algebroid, will be considered
in next Sections.

\subsection{Flat bundles  with the regular singularities}

Consider a ${\rm SL}(N,{\bf C})$ holomorphic bundle  $E$ over
 $\Sigma_{g,n}$.
Let $D^*$ be a small punctured disk embedded to $\Sigma_{g,n}$
with a local coordinate $z$.
Locally  the derivatives
 $d': E\to E\otimes\Omega^{(1,0)}(\Sigma_{g,n})$,
$d'': E\to E\otimes\Omega^{(0,1)}(\Sigma_{g,n})$ take the form
\begin{equation}\label{8.0}
d'=\partial +A\,, ~~d''=\bar{\partial}\,.
\end{equation}

Let $M_{SL_N}(D^*)=\{d'=k\partial+A\}$ be the set of
derivatives restricted to $D^*$.  This set has the structure
of the affine Lie coalgebra
$\hat{L}^*(\sln)$ with the Lie-Poisson brackets on the space of smooth functionals
$$
\{f(A),g(A)\}=
\oint{\rm tr}([df(A),dg(A)]A)+
\oint{\rm tr}(df\partial (dg) )\,,
$$
where $df(A)\in L(\sln)$ is the variation of $f(A)$.
Thereby $M_{SL_N}(D^*)$ can be considered as
 the base of the Lie algebroid ${\cal A}_{SL_N}(D^*)$
 (see Remark 3.1).
The space of sections of the algebroid is the Lie algebra
${\cal G}_{SL_N}(D^*)=L(\sln)$
of  the gauge transformations
\begin{equation}\label{8.1}
\delta_\varepsilon A=\partial\varepsilon+[A,\varepsilon]\,.
\end{equation}

Though the Poisson structure
is defined only on $D^*$ the algebroid
can be defined over $\Sigma_{g,n}$, since the gauge algebra
and the anchor action (\ref{8.1}) are well defined globally.
We denote by ${\cal G}_{SL_N}$  the algebra
of the smooth global gauge transformations.
To come to the global description
we assume that $A$ has first order holomorphic poles at the marked points
\begin{equation}\label{8.0a}
A|_{z\to x_a}=\frac{A_a}{z-x_a}\,.
\end{equation}
In addition, we consider a collection $P$ of $n$  elements from  the
Lie coalgebra
$$
P=\left\{\bfp=(p_1,\ldots,p_a,\ldots,p_n), ~~p_a\in{\rm sl}^*(N,{\mC})\right\}\,.
$$
endowed with the Lie-Poisson structure
$
\{f(p_a),g(p_b)\}=\delta_{ab}{\rm tr}([ df,dg]p_a)$.
We assume that the gauge transformations at the marked points are nontrivial
\begin{equation}\label{8.0b}
\varepsilon|_{z\to x_a}=r_a+O(z-x_a)\,, ~~r_a\neq 0\,.
\end{equation}
The gauge algebra ${\cal G}_{SL_N}$ acts on $P$ by the evaluation maps
\begin{equation}\label{8.1a}
\delta_\varepsilon p_a=[p_a,r_a]\,,~~
\varepsilon\in {\cal G}_{SL_N}\,.
\end{equation}
In this way we define a trivial Lie algebroid
${\cal A}_{SL_N} ={\cal G}_{SL_N}\times M_{SL_N}$
over
$M_{SL_N}=\{d',P\}$  with the anchor map (\ref{8.1}), (\ref{8.1a}).

The cohomology
$H^i({\cal A}_{SL_N})=H^i({\cal G}_{SL_N},M)$
are the standard cohomology
of the gauge algebra ${\cal G}_{SL_N}$ with the cochains taking values
in functionals on $M$.  There is a nontrivial one-cocycle
\begin{equation}\label{8.2}
c(A,\bfp;\varepsilon)=\int_{\Sigma_{g,n}}{\rm tr}\varepsilon
\left(
\bar{\partial} A-2\pi i\sum_{a=1}^n\delta(x_a)p_a
\right)=
\langle\varepsilon|\bar{\partial} A\rangle-2\pi i\sum_{a=1}^n{\rm tr}(r_a\cdot p_a)
\end{equation}
representing an element of $H^1({\cal A}_{SL_N})$.
 This cocycle provides a nontrivial
extension of the anchor action (see (\ref{5.11}))
\begin{equation}\label{8.2a}
\hat{\delta}_\varepsilon f(A,\bfp)
=\langle\varepsilon
|\bar{\partial} A-\partial (df(A))+[df(A),A]\rangle
-2\pi i\sum_{a=1}^n{\rm tr}(r_a p_a) \,.
\end{equation}


Next consider $2g$ contours $\gamma_\alpha,~(\alpha=1,\ldots,2g)$
 generating $\pi_1(\Sigma_{g})$. The contours determine the 2-cocycles
\begin{equation}\label{8.3}
c_\alpha(\varepsilon_1,\varepsilon_2)=\int_{\gamma_\alpha}{\rm tr}(\varepsilon_1\partial\varepsilon_2)\,.
\end{equation}
The cocycles (\ref{8.3}) lead to $2g$ central extensions
$\hat{\cal G}_{SL_N}$ of ${\cal G}_{SL_N}$
$$
\hat{\cal G}_{SL_N}={\cal G}_{SL_N}\oplus_{\alpha=1}^{2g}{\bf C}\Lambda_\alpha\,,
$$
$$
[(\varepsilon_1,\sum_{\alpha}k_{1,\alpha}),(\varepsilon_2,\sum_{\alpha}k_{2,\alpha})]_{c.e.}=
\left([\varepsilon_1,\varepsilon_2],\sum_{\alpha}c_\alpha(\varepsilon_1,\varepsilon_2)\right)\,.
$$

To define the corresponding Poisson sigma-model we
consider the cotangent bundle $T^*E$.
The conjugate to
$\partial +A$ variables are the one-forms
$\bar{\Phi}\in\Omega^{(0,1)}(\Sigma_{g,n},{\rm sl}(N,{\mC}))$
 -- the antiHiggs field.
In fact, we shall consider the affinization
${\cal R}^0_{SL_N}=Aff(T^*E)$ over
$T^*E$ provided
by the cocycle (\ref{8.2}). We have already mentioned that
 the role of momenta plays by  the holomorphic connection $\bar{\partial}+\bar{A}$ (\ref{na}).
 We put $\kappa=1$. The symplectic form on ${\cal R}^0_{SL_N}$ is
$$
\omega^0= \langle DA\wedge D\bar{A}\rangle\,.
$$

Consider the contributions of the marked points. We define there the symplectic manifold
$$
(T^*G_1,\ldots,T^*G_n)\,.
$$
The dual variables to $p_a$ at the marked points are $n$ elements
 $g_a\in{\rm SL}(N,{\mC})$
and the symplectic form  is
\begin{equation}\label{8.4c}
\sum_{a=1}^n\omega_a=\sum_{a=1}^nD{\rm tr}(p_a\wedge g_a^{-1}Dg_a)\,.
\end{equation}
Here
$\omega_a$
is the canonical symplectic form on $T^*G_a\sim T^*{\rm SL}(N,{\mC})$.
We pass from $T^*G_a$ to the coadjoint orbits
$$
{\cal O}_a=\{p_a=g_a^{-1}p_a^{(0)}g_a~|~p_a^{(0)}={\rm diag}(\lambda_{a,1},\ldots,\lambda_{a,N}),~
\lambda_{a,j}\neq\lambda_{a,k},~g_a\in{\rm SL}(N,{\bf C})\}\,,
$$
The orbits are the symplectic quotient
${\cal O}_a\sim {\rm SL}(N,{\mC})\backslash\backslash  T^*G_a$ with respect to the action\\
$g_a\to f_ag_a,~f_a\in{\rm SL}(N,{\mC})$.
The form $\omega_a$ coincides on ${\cal O}_a$ with the Kirillov-Kostant form
$\omega_a=D{\rm tr}(p^{(0)}_a Dg_ag_a^{-1})$. The orbits ${\cal O}_a$ are
affinizations $Aff(T^*Fl_a(N))$ over
the cotangent bundles $T^*Fl_a(N)$ to the flag varieties $Fl_a(N)$.

Eventually we come
 to the symplectic manifold
$$
{\cal R}_{SL_N}=({\cal R}^0_{SL_N};{\cal O}_1,\ldots,{\cal O}_n)\sim Aff(T^*E);Aff(T^*Fl_1),\ldots,Aff(T^*Fl_n)\,,
$$
\begin{equation}\label{8.4a}
\omega=\omega^0+\sum_{a=1}^n\omega_a=\langle DA\wedge D\bar{A}\rangle+\sum_{a=1}^nD{\rm tr}(p^0_a\wedge Dg_a g_a^{-1})\,.
\end{equation}

 According to
(\ref{5.17}) the lift of the anchor (\ref{8.1}) to ${\cal R}_{N}$,
defined by the cocycle $c(A;\varepsilon)$ (\ref{8.2}) leads  to the Hamiltonian
$$
h_\varepsilon=
\langle\varepsilon|F(A,\bar{A})-2\pi i\sum_{a=1}^n\delta(x_a)p_a)\rangle,~~
F(A,\bar{A})=\bar{\partial} A-\partial\bar{A}+[\bar{A},A]\,.
$$
The Hamiltonian generates the canonical vector fields (\ref{8.1}) (\ref{8.1a}) and
$$
\hat{\delta}_\varepsilon \bar{A}=\bar{\partial}\varepsilon+[\bar{A},\varepsilon],~~\hat{\delta}_\varepsilon g_a=g_ar_a,
$$
(see (\ref{5.16a})).
The global version of this transformations is the gauge group
$G_{SL_N}$ acting on ${\cal R}_{SL_N}$.
The flatness condition
\begin{equation}\label{8.5a}
m:=F(A,\bar{A})-2\pi i\sum_{a=1}^n\delta(x_a)p_a=0
\end{equation}
is the moment constraint with respect to this action. This equation means
that the residues $A_a$ of $A$ in the marked points (\ref{8.0a}) coincide with
$p_a$.
The flatness is the compatibility condition for the linear
system
\begin{equation}\label{8.5c}
\left\{
\begin{array}{c}
(\partial +A)\psi=0\,,\\
(\bar{\partial} +\bar{A})\psi=0\,,
\end{array}
\right.
\end{equation}
where $\psi\in\Omega^0(\Sigma_{g,n},{\rm Aut} E)$. The second equation
describes the deformation of the holomorphic structure of the bundle $E$
 (\ref{8.0}).

The moduli space ${\cal M}^{flat}_N$ of flat ${\rm SL}(N,{\mC})$-bundles
is the symplectic quotient
${\cal R}_{SL_N}//G_{SL_N}$. It has  dimension
\begin{equation}\label{8.5b}
\dim {\cal M}^{flat}_N=2(N^2-1)(g-1)+N(N-1)n\,,
\end{equation}
where the last term is the contribution of the coadjoint orbits ${\cal O}_a$.
Let
$\tilde{M}_{SL_N}=M_{SL_N}/G_{SL_N}$ be the set of the
gauge orbits acting on the base space $M_{SL_N}=\{d',P\}$.
Consider smooth functionals $\Psi(A,\bfp)$ annihilated by the
anchor action $\hat{\delta}_\varepsilon\Psi(A,\bfp)=0$.
These functionals generate the space of sections of the linear bundle
${\cal L}(\tilde{M}_{SL_N})$ we
discussed before (\ref{5.11b}). It  is the determinant bundle
 $\det(\partial+A)$ \cite{ADW,H1}.
The prequantization of ${\cal M}^{flat}_N$ is defined in the Hilbert space
 $L^2(\Gamma({\cal L}(\tilde{M}_{SL_N}))$.

On the other hand ${\cal M}^{flat}_N$ can be described by the
cohomology $H^k(Q)$ of the BRST operator $Q$ which we are going to define.
Let $\eta$ be the  dual to $\varepsilon$ fields (the ghosts)
and ${\cal P}$ are their momenta ${\cal P}\in\Omega^{(1,1)}(\Sigma_{g,n},{\rm End}E)$.
 Consider the algebra
$$
C^\infty({\cal R}_{N})\otimes\wedge^\bullet
 \left({\cal G}_{ SL_N})\oplus {\cal G}^*_{ SL_N}\right)\,.
$$
Then the BRST operator $Q$ acts on functionals on this algebra as
$$
Q\Psi(A,\bar{A},\eta,{\cal P})=\{\Omega,\Psi(A,\bar{A},\eta,{\cal P})\}\,,
$$
 where
$$
\Omega=\langle \eta|F(A,\bar{A})\rangle   +\frac{1}{2}\langle [\eta,\eta']|{\cal P}\rangle   \,,
$$
where res$A|_{x_a}=p_a$.


\subsection{Projective structures on $\Sigma_{g,n}$}

Consider the space $M_2$ of
projective connections  on $\Sigma_{g,n}$. Locally  on a punctured disk
$D^*$ the space $M_2$ is  represented by
the set $M_2(D^*)$ of the second order differential operators $\partial^2-T$.
The later is the Poisson manifold
with the linear brackets
\begin{equation}\label{vir}
\{T(z),T(w)\}=(\frac{1}{2}\partial^3+2T\partial+\partial T)\delta(z-w)\,,
\end{equation}
 where $ \delta(z-w)=\sum_{k\in\mZ}z^kw^{-k-1}$ is the delta function
 on the contour $|z|=1$.

 The dual space to $M_2(D^*)$  is the  Virasoro algebra $Vir={\cal G}_1(D^*)=\{\varepsilon,\bfc\}$
  $(\varepsilon=\varepsilon(z,\bar{z})\frac{\partial}{\partial z})$. The commutation relations can be read off
 from the Poisson brackets  (see (\ref{2.3}))
\begin{equation}\label{8.7b}
[\varepsilon_1,\varepsilon_2]=(\varepsilon_1\partial\varepsilon_2-\varepsilon_2\partial\varepsilon_1, \frac{1}{2}\oint\varepsilon_1\partial^3\varepsilon_2)\,.
\end{equation}

 The coadjoint action of $Vir$ on $M_2(D^*)$
\begin{equation}\label{8.7}
\delta_{\varepsilon}T(z,\bar{z})=-\varepsilon\partial T-2T\partial\varepsilon-\frac{1}{2}\partial^3\varepsilon\,.
\end{equation}
defines the anchor in the trivial algebroid ${\cal A}_{2}(D^*)={\cal G}_1(D^*)\oplus M_2(D^*)$.

The algebroid (\ref{8.7b}), (\ref{8.7}) can be  defined
globally over the space $M_2$.  The section of the algebroid are the chiral
vector fields $\varepsilon\sim \varepsilon(z,\bar{z})\frac{\partial}{\partial z}$ on $\Sigma_{g,n}$.  Its central
extension is defined by the contour in $D^*$ (\ref{8.7b}).
 We call this algebra ${\cal G}_1$.
We include in the definition the contribution of the marked points.
Assume that the projective connections $T$ have
poles at the marked points $x_a,(a=1,\ldots,n)$
  up to the second order:
\begin{equation}\label{8.8a}
T|_{z\rightarrow x_a}\sim\frac{T^a_{-2}}{(z-x_a)^2}+\frac{T^a_{-1}}{(z-x_a)}+\ldots\,,
\end{equation}
and the vector fields have the first order holomorphic nulls at the marked points
\begin{equation}\label{8.8b}
\varepsilon|_{z\rightarrow x_a}=r_a(z-x_a)+o(z-x_a),~~r_a\neq 0\,.
\end{equation}
We denote this trivial algebroid bundle  ${\cal A}_2$.

Consider the cohomology $H^\bullet ({\cal A}_2)\sim H^\bullet ({\cal G}_1,M_2)$.
Due to (\ref{8.7}) and (\ref{8.8b})  $\delta_{\varepsilon}T^a_{-2}=0$ and thereby
 $T^a_{-2}$ in (\ref{8.8a}) represents an element
from $H^0({\cal A}_2)$.

The anchor action (\ref{8.7}) can be extended by the one-cocycle $c(T;\varepsilon)$
representing a nontrivial element $c(\varepsilon;T)$ of $H^1({\cal A}_2)$
\begin{equation}\label{8.9a}
c(T;\varepsilon)=\int_{\Sigma_{g,n}}\varepsilon\bar{\partial} T=\langle\varepsilon|\bar{\partial} T\rangle\,,
\end{equation}
\begin{equation}\label{8.9}
\hat{\delta}_{\varepsilon}f(T)=\langle\delta_\varepsilon T|df(T)\rangle+c(T;\varepsilon)\,.
\end{equation}
The contribution of the marked point in (\ref{8.9a}) is $2\pi ir_aT_{-2}^a$.

There exist  $2g$ nontrivial two-cocycles defined by the integrals
over non contractible contours $\gamma_\alpha$:
$$
c_\alpha (\varepsilon_1,\varepsilon_2)=\oint_{\gamma_\alpha}\varepsilon_1\partial^3\varepsilon_2.
$$
The cocycles give rise to the central extension $\hat{\cal G}_1$ of the Lie algebra
of the first order differential operators on $\Sigma_g$.

The affinization ${\cal R}_2$ over the cotangent bundle $T^*M_2$ has
the Darboux coordinates
$T$ and $\mu$,
where $\mu\in\Omega^{(-1,1)}(\Sigma_{g,n})$ is the Beltrami differential.
The anchor (\ref{8.7}) is lifted to ${\cal R}_2$ as
\begin{equation}\label{8.11}
\delta_\varepsilon\mu=-\varepsilon\partial\mu +\mu\partial\varepsilon+\bar{\partial}\varepsilon\,,
\end{equation}
where the last term occurs due to the cocycle (\ref{8.9a}).
We specify the dependence of $\mu$ on the positions of
the marked points in the following  way. Let ${\cal U}'_a$ be
 neighborhoods
 of the marked points $x_a,~(a=1,\ldots,n)$
such that ${\cal U}'_a\cap{\cal U}'_b=\emptyset$ for $a\neq b$.
Define a smooth function $\chi_a(z,\bar{z})$
\begin{equation}\label{cf}
\chi_a(z,\bar{z})=\left\{
\begin{array}{cl}
1,&\mbox{$z\in{\cal U}_a$ },~{\cal U}'_a\supset{\cal U}_a\\
0,&\mbox{$z\in\Sigma_g\setminus {\cal U}'_a$}\,.
\end{array}
\right.
\end{equation}
Due to (\ref{8.11}) at the neighborhoods of the marked points $\mu$ is defined
 up to the term\\ $\bar{\partial}(z-x_a)\chi(z,\bar{z})$.
Then $\mu$ can be represented as
\begin{equation}\label{mu}
 \mu=\sum_{a=1}^n[t^{(1)}_{0,a}+t^{(1)}_{1,a}(z-x_a)+\ldots]\mu^0_a\,,~~
\mu^0_a=\bar{\partial} \chi_a(z,\bar{z})\,,~~(t_{0,a}=x_a-x_a^0)\,,
\end{equation}
where only $t_{0,a}$ can not be removed by the gauge transformations (\ref{8.8b}), (\ref{8.11}).
The symplectic form on ${\cal R}_2$ is
$$
\omega=\int_{\Sigma_{g,n}}dT\wedge d\mu=\langle dT\wedge d\mu\rangle\,.
$$
For rational curves $\Sigma_{0,n}$ it takes the form
\begin{equation}\label{8.14}
\omega=dT^a_{-2}\wedge dt_{1,a}+dT^a_{-1}\wedge dt_{0,a}\,.
\end{equation}
\begin{rem}
The space ${\cal R}_2$ is the classical phase space
of the $2+1$-gravity on $\Sigma_{g,n}\times I$ \cite{Ca}. In fact,
$\mu$ is related to the conformal class of metrics on $\Sigma_{g,n}$
and plays the role of a coordinate, while $T$ is a momentum.
In our construction $\mu$ and $T$ interchange their roles.
\end{rem}

The Hamiltonian of the canonical transformations (\ref{8.7}), (\ref{8.11})
has the form
\begin{equation}\label{8.12}
h_\varepsilon=\langle\varepsilon| F(T,\mu)\rangle\,,
\end{equation}
$$
F(T,\mu)=
(\bar{\partial}+\mu\partial+2\partial\mu)T-\frac{1}{2}\partial^3\mu\,.
$$

The Hamiltonian defines the moment map  $m:{\cal R}_2\rightarrow {\cal G}^*_1$
\begin{equation}\label{8.13}
m=(\bar{\partial}+\mu\partial+2\partial\mu)T-\frac{1}{2}\partial^3\mu\,,
\end{equation}
where ${\cal G}^*_{1}$ is the dual to ${\cal G}_{1}$ space
of distributions  of $(2,1)$-forms on $\Sigma_{g,n}$.
As it follows from
(\ref{8.8b}) in the neighborhoods of the marked points the elements
 $y\in{\cal G}^*_{1}$ takes the form
\begin{equation}\label{8.13a}
y\sim b_{1,a}\partial\delta(x_a)+b_{2,a}\partial^2\delta(x_a)+\ldots\,.
\end{equation}
We put $m$ equal
\begin{equation}\label{8.15}
m=-\sum_{a=1}^nT^a_{-2}\partial\delta(x_a)\,,~~(m=F(T,\mu))\,.
\end{equation}
The algebra  ${\cal G}_1$  preserves $m:{\rm ad}_\varepsilon^*m=m$
for any $\varepsilon$.
Thus, in contrast with the previous example, we have trivial coadjoint orbits at
the marked points. Since $T^a_{-2}$ are fixed, the dynamical parameters  are
$(t_{0,a},T^a_{-1})$ that contribute in the symplectic structure (\ref{8.14}).
Let $\psi$ be a $(-\frac{1}{2},0)$ differential. Then (\ref{8.15})
is the compatibility condition for the linear system
\begin{equation}\label{8.16}
\left\{
\begin{array}{l}
(\partial^2-T)\psi=0\,,\\
(\bar{\partial}+\mu\partial -\frac{1}{2}\partial\mu) \psi=0\,.
\end{array}
\right.
\end{equation}
It follows from the second equation that the Beltrami differential $\mu$ provides
 the deformation of complex structure on $\Sigma_{g,n}$. Note, that we started
from the first equation defining the projective
connection  and $\bar{\partial}\psi=0$ on $M_2$. The last equation is modified
after the passage from $M_2$ to  ${\cal R}_2$.


The moduli space ${\cal W}_2$ of projective structure on $\Sigma_{g,n}$ is
the symplectic quotient of ${\cal R}_2$ with respect to the action of $G_1$,
where $G_1$ is the group corresponding to the algebra ${\cal G}_1$
$$
{\cal W}_2={\cal R}_2//G_1=\{F(T,\mu)-m=0\}/G_1\,.
$$
It has dimension $6(g-1)+2n$. To quantize ${\cal W}_2$
 one can consider the quotient space $\tilde{M}_2=M_2/G_1$.
 The space of sections of
the linear bundle ${\cal L}(\tilde{M}_2)$ is defined as the space of
functionals $\{\Psi(T)\}$ on $M_2$ that satisfy the invariance condition\\
$\hat{\delta}_\varepsilon\Psi(T)=0$.
The linear bundle ${\cal L}(\tilde{M}_2)$ is the determinant line bundle
$\det(\partial^2-T)$ considered in \cite{Za,Mat}.

The tangent space ${\cal T}_2$ to ${\cal W}_2$ is isomorphic
to the cohomology $H^0$ of the BRST complex. It is generated by
the fields $T,\mu\in {\cal R}_2$, the ghosts fields $\eta$ dual to the
vector fields $\varepsilon$ acting via the anchor (\ref{8.7}),(\ref{8.11})
on ${\cal R}_2$ and the ghosts momenta ${\cal P}$.
The BRST operator $Q$ is defined by $\Omega$
$$
\Omega=\int_{\Sigma_{g,n}}\eta F(T,\mu)+\frac{1}{2}\int_{\Sigma_{g,n}}[\eta,\eta']{\cal P}.
$$
The first term is just the Hamiltonian (\ref{8.12}), where the vector fields are
replaced by the ghosts.

\section{Hamiltonian algebroid structure in ${\cal W}_3$-gravity}
\setcounter{equation}{0}

Now consider the concrete example of the general construction with nontrivial
algebroid structure.
It is the ${\cal W}_N$-structures on $\Sigma_{g,n}$ \cite{P,BFK,GLM}
which generalize the projective structures described in previous Section.
In this Section we consider in details the ${\cal W}_3$-structures.

\subsection{${\rm SL}(N,{\mC})$-opers}

Opers are $G$-bundles over Riemann curves with additional structures
\cite{Tel,BD}.
Let $E_N$ be a  ${\rm SL}(N,{\mC})$-bundle over $\Sigma_{g,n}$. It is a ${\rm SL}(N,{\mC})$-{\em oper} if
 there exists a flag filtration
$E_N\supset  \ldots\supset   E_1\supset    E_0=0$ and a covariant derivative,
 that acts as
$\nabla:~E_j\subset E_{j+1}\otimes\Omega^{(1,0)}(\Sigma_{g,n})$.
Moreover, $\nabla$ induces an isomorphism
$E_j/E_{j-1}\to E_{j+1}/E_{j}\otimes\Omega^{(1,0)}(\Sigma_{g,n})$.
It means that locally
\begin{equation}\label{opN}
\nabla=\partial-
\left(
\begin{array}{cccccc}
0   & 1 & 0 & \ldots&   & 0 \\
0   & 0 & 1 & \ldots&   &   \\
    &   &   & \cdot &   &   \\
 0  & 0 &   &       & 0&  1  \\
W_N& W_{N-1}&\ldots&&W_2&0
\end{array}
\right)\,.
\end{equation}
In other word we define the $N$-order differential operator on $\Sigma_{g,n}$
\begin{equation}\label{dopN}
L_N=\partial^N-W_2\partial^{N-2}\ldots-W_N~:
~\Omega^{(-\frac{N-1}{2},0)}(\Sigma_{g,n})\to\Omega^{(\frac{N+1}{2},0)}(\Sigma_{g,n})
\end{equation}
with vanishing subprinciple symbol. The ${\rm GL}(N,{\mC})$-opers come from the ${\rm GL}(N,{\mC})$-bundles
and have the additional term $-W_1\partial^{N-1}$ in (\ref{dopN}).
We assume that in  neighborhoods  of the marked points
the coefficients $W_j$ behave as
\begin{equation}\label{6.4a}
W_j|_{z\rightarrow x_a}\sim
W^a_{-j}(j){(z-x_a)^j}+W^a_{-j}(j-1){(z-x_a)^{j-1}}+
\ldots\,.
\end{equation}

In this section we consider ${\rm SL}(3,{\mC})$-opers and postpone the general case to next Section.
It is possible to choose $E_1=\Omega^{-1,0}(\Sigma_{g,n})$.
Instead of (\ref{opN}) we have
\begin{equation}\label{6.1}
\nabla=\partial -\left(
\begin{array}{ccc}{0}&{1}&{0}\\{0}&{0}&{1}\\
{W}&{T}&{0}
\end{array}\right)\,,
\end{equation}
and the third order differential operator
\begin{equation}\label{6.2}
L_3=\partial^3-T\partial-W:~\Omega^{(-1,0)}(\Sigma_{g,n})\to\Omega^{(2,0)}(\Sigma_{g,n})\,.
\end{equation}
According with (\ref{6.4a})
\begin{equation}\label{6.3}
T|_{z\rightarrow x_a}\sim\frac{T^a_{-2}}{(z-x_a)^2}+\frac{T^a_{-1}}{(z-x_a)}+\ldots\,.
\end{equation}
\begin{equation}\label{6.4}
W|_{z\rightarrow x_a}\sim
\frac{W^a_{-3}}{(z-x_a)^3}+\frac{W^a_{-2}}{(z-x_a)^2}+\frac{W^a_{-1}}{(z-x_a)}
+\ldots\,.
\end{equation}

\subsection{Local Lie algebroid over SL$(3,\mC)$-opers}

Consider the set $M_3(D^*)=\{L_3\}$ of ${\rm SL}(3,{\mC})$-opers on a punctured disk $D^*$.
This set is a Poisson manifold with respect to the AGD brackets
\begin{equation}\label{6.9a}
\{T(z),T(w)\}
=\left(-2\kappa\partial^3+2T(z)\partial+\partial T(z)\right)\delta(z-w)\,,
\end{equation}
\begin{equation}\label{6.10a}
\{T(z),W(w)\}=\left(\partial^4-T(z)\partial^2+3W(z)\partial-\partial W(z)\right)\delta(z-w)\,,
\end{equation}
\begin{equation}\label{6.12a}
\{W(z),W(w)\}=
\end{equation}
$$
+\left(\frac{2}{3}\partial^5-\frac{4}{3}T(z)\partial^3-
2\partial T(z)\partial^2+\left(\frac{2}{3}T(z)^2-2\partial^2T(z)+2\partial W(z)\right)\partial
\right.
$$
$$
\left. +\left(\partial^2W(z)-\frac{2}{3}\partial^3T(z)+\frac{2}{3}T(z)\partial T(z)\right)
\right)\delta(z-w)\,.
$$

It means that $M_3(D^*)$ is a base of the local Lie algebroid
${\cal A}_3(D^*)\sim T^*M_3(D^*)$.
To define the space of its sections we consider
the dual space  $M^*_3 (D^*)$ of the space of second order differential operators on $D^*$ with a central extensions
$$
M^*_3 (D^*)=
\{ (\varepsilon^{(1)}\frac{d}{dz}+ \varepsilon^{(2)}\frac{d^2}{dz^2}),c\}\,.
$$
It comes from the pairing
\begin{equation}\label{pa}
\oint_{|z|=1}(\varepsilon^{(1)}T+ \varepsilon^{(2)}W)
\end{equation}
and the central element $c$ is dual to the highest order coefficient
in(\ref{6.3}) which we put equal to $1$.
The Lie brackets on $ T^*M_3 (D^*)$ are determined by means of
the AGD Poisson structure following  (\ref{2.3})
\begin{equation}\label{6.6}
\lb\varepsilon^{(1)}_1,\varepsilon^{(1)}_2\rb=
\left((\varepsilon^{(1)}_1\partial\varepsilon^{(1)}_2-\varepsilon^{(1)}_2\partial\varepsilon^{(1)}_1) \frac{d}{dz}\,,\,
-2\oint\varepsilon^{(1)}_1\partial^3\varepsilon^{(1)}_2\right)\,.
\end{equation}
\begin{equation}\label{6.7}
\lb\varepsilon^{(1)},\varepsilon^{(2)}\rb=\left((
-\varepsilon^{(2)}\partial^2\varepsilon^{(1)}) \frac{d}{dz}+( -2\varepsilon^{(2)}\partial\varepsilon^{(1)}+\varepsilon^{(1)}\partial\varepsilon^{(2)}) \frac{d^2}{dz^2})\,,\,
\oint\varepsilon^{(1)}_1\partial^4\varepsilon^{(2)}_2\right)\,.
\end{equation}
\begin{equation}\label{6.8}
\lb\varepsilon^{(2)}_1,\varepsilon^{(2)}_2\rb=\left(
\frac{2}{3}[\partial(\partial^2-T)\varepsilon^{(2)}_1]\varepsilon^{(2)}_2 -
 \frac{2}{3}[\partial(\partial^2-T)\varepsilon^{(2)}_2]\varepsilon^{(2)}_1) \frac{d}{dz}\right. +
\end{equation}
$$
\left.
(\varepsilon^{(2)}_2\partial^2\varepsilon^{(2)}_1-\varepsilon^{(2)}_1\partial^2\varepsilon^{(2)}_2)\frac{d^2}{dz^2}\,,
\,\frac{2}{3}\oint\varepsilon^{(2)}_1\partial^5\varepsilon^{(2)}_2\right)\,.
$$
Note, that the brackets (\ref{6.6}) are the Virasoro brackets and the whole
set of the commutation relations is their generalization on the second order
differential operators.

According with (\ref{dx}) the anchor action in ${\cal A}_3(D^*)$ has the form
\begin{equation}\label{6.9}
\delta_{\varepsilon^{(1)}}T=-2\partial^3\varepsilon^{(1)}+2T\partial\varepsilon^{(1)}+\partial T\varepsilon^{(1)}\,,
\end{equation}
\begin{equation}\label{6.10}
\delta_{\varepsilon^{(1)}}W=-\partial^4\varepsilon^{(1)}+3W\partial\varepsilon^{(1)}+\partial W\varepsilon^{(1)}+T\partial^2\varepsilon^{(1)}\,,
\end{equation}
\begin{equation}\label{6.11}
\delta_{\varepsilon^{(2)}}T=\partial^4\varepsilon^{(2)}-T\partial^2\varepsilon^{(2)}+(3W-2\partial T)\partial\varepsilon^{(2)}+
(2\partial W-\partial^2T)\varepsilon^{(2)}\,,
\end{equation}
\begin{equation}\label{6.12}
\delta_{\varepsilon^{(2)}}W=\frac{2}{3}\partial^5\varepsilon^{(2)}-\frac{4}{3}T\partial^3\varepsilon^{(2)}-
2\partial T\partial^2\varepsilon^{(2)}+
\end{equation}
$$
(\frac{2}{3}T^2-2\partial^2T+2\partial W)\partial\varepsilon^{(2)}+
(\partial^2W-\frac{2}{3}\partial^3T+\frac{2}{3}T\partial T)\varepsilon^{(2)}\,.
$$
Thereby, we come to the Lie algebroid ${\cal A}_3(D^*)$ over $M_3(D^*)$.
This algebroid is nontrivial since
the structure functions in (\ref{6.8}) depend on  the projective connection $T$.

The SAJI (\ref{5.5}) in ${\cal A}_3(D^*)$ takes the form
\begin{equation}\label{6.14}
\lb\lb\varepsilon^{(2)}_1,\varepsilon^{(2)}_2\rb,\varepsilon^{(2)}_3\rb^{(1)}-
(\varepsilon^{(2)}_1\partial\varepsilon^{(2)}_2-\varepsilon^{(2)}_2\partial\varepsilon^{(2)}_1)\delta_{\varepsilon^{(2)}_3}T+{\rm c.p.}(1,2,3)
=0,
\end{equation}
\begin{equation}\label{6.15}
\lb\lb\varepsilon^{(2)}_1,\varepsilon^{(2)}_2\rb,\varepsilon^{(1)}_3\rb^{(1)}-
(\varepsilon^{(2)}_1\partial\varepsilon^{(2)}_2-\varepsilon^{(2)}_2\partial\varepsilon^{(2)}_1)\delta_{\varepsilon^{(1)}_3}T=0.
\end{equation}
The brackets here correspond to the product of
structure functions in the left hand side
of (\ref{5.5}) and the superscript $(1)$ corresponds to the ${\cal D}^1$ component.
For the  rest  brackets the Jacobi identity is the standard one.

The origin of the brackets and the anchor representations follow from the
matrix description of ${\rm SL}(3,{\mC})$-opers (\ref{6.1}).
Consider the set $G_3(D^*)$ of automorphisms of the bundle $E_3$ over $D^*$
\begin{equation}\label{6.15a}
A\to f^{-1}\partial f-f^{-1}Af\,,
\end{equation}
that preserve the ${\rm SL}(3,{\mC})$-oper structure
\begin{equation}\label{6.16}
f^{-1}\partial f-
f^{-1}\left(
\begin{array}{ccc}{0}&{1}&{0}\\{0}&{0}&{1}\\
{W}&{T}&{0}
\end{array}\right)f=
\left(
\begin{array}{ccc}{0}&{1}&{0}\\{0}&{0}&{1}\\
{W'}&{T'}&{0}
\end{array}\right)\,.
\end{equation}
It is clear that $G_3(D^*)$ is the Lie groupoid over  $M_3 (D^*)=\{W,T\}$ with
$l(f)=(W,T)$, $~r(f)=(W',T')$, $~f\to << W,T|f|W',T'>>$.
The left identity map is the ${\rm SL}(3,{\mC})$  subgroup of $G_3$
$$
P\exp(-\int^z_{z_0} A(W,T))\cdot C\cdot P\exp(\int^z_{z_0} A(W,T))\,,
$$
where $C$ is an arbitrary matrix from ${\rm SL}(3,{\mC})$ and $A(W,T))$ has the oper structure (\ref{6.1}).
The right identity map has the same
form with $(W,T)$ replaced by $(W',T')$.

The local version of (\ref{6.16}) takes the form
\begin{equation}\label{6.17}
\partial X-\left[\left(
\begin{array}{ccc}{0}&{1}&{0}\\{0}&{0}&{1}\\
{W}&{T}&{0}
\end{array}\right),X\right]=
\left(
\begin{array}{ccc}{0}&{0}&{0}\\{0}&{0}&{0}\\
{\delta W}&{\delta T}&{0}
\end{array}\right)\,.
\end{equation}
It is the sixth order linear differential system for the matrix elements of the
traceless matrix $X$. The matrix elements $x_{j,k}\in\Omega^{(j-k,0)}(\Sigma_{g,n})$
 depend on two arbitrary fields $x_{23}=\varepsilon^{(1)},~x_{13}=\varepsilon^{(2)}$. The
solution takes the form
\begin{equation}\label{6.17b}
X="
